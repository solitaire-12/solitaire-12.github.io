{"meta":{"title":"ç»‡ç§‹ä¸ªäººåšå®¢","subtitle":"å‰¯æ ‡é¢˜","description":"åº§å³é“­","author":"solitaire-12","url":"https://solitaire-12.github.io","root":"/"},"pages":[{"title":"","date":"2024-03-14T09:19:27.963Z","updated":"2024-03-14T09:19:27.963Z","comments":true,"path":"404.html","permalink":"https://solitaire-12.github.io/404.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2024-03-14T07:40:18.000Z","updated":"2024-03-14T08:58:24.939Z","comments":true,"path":"categories/index.html","permalink":"https://solitaire-12.github.io/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2024-03-19T04:54:36.000Z","updated":"2024-03-19T04:54:36.253Z","comments":true,"path":"about/index.html","permalink":"https://solitaire-12.github.io/about/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2024-03-14T08:59:43.000Z","updated":"2024-03-14T09:00:13.560Z","comments":true,"path":"links/index.html","permalink":"https://solitaire-12.github.io/links/index.html","excerpt":"","text":""},{"title":"frineds","date":"2024-03-19T04:55:03.000Z","updated":"2024-03-19T04:55:03.563Z","comments":true,"path":"frineds/index.html","permalink":"https://solitaire-12.github.io/frineds/index.html","excerpt":"","text":""},{"title":"tags","date":"2024-03-14T08:59:06.000Z","updated":"2024-03-14T08:59:23.315Z","comments":true,"path":"tags/index.html","permalink":"https://solitaire-12.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Java|Java8","slug":"Java/Java8","date":"2024-03-18T12:14:55.000Z","updated":"2024-03-19T00:38:25.379Z","comments":true,"path":"2024/03/18/Java/Java8/","permalink":"https://solitaire-12.github.io/2024/03/18/Java/Java8/","excerpt":"","text":"java8å®æˆ˜æ±‡æ€» Lambdaè¡¨è¾¾å¼ Lambdaè¡¨è¾¾å¼æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå‚æ•°-&gt;ä¸»ä½“ 12(parameters) -&gt; expression(parameters) -&gt;&#123; statements; &#125; 123456789() -&gt; &#123;&#125; () -&gt; &quot;Raoul&quot;() -&gt; &#123;return &quot;Mario&quot;; &#125;// returnæ˜¯ä¸€ä¸ªæ§åˆ¶æµè¯­å¥ã€‚è¦ä½¿ç”¨æ­¤Lambdaæœ‰æ•ˆï¼Œéœ€è¦ä½¿ç”¨èŠ±æ‹¬å·(Integer i) -&gt; return &quot;Alan&quot; + i; (Integer i) -&gt; &#123;return &quot;Alan&quot; + i;&#125;// â€œIron Manâ€æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸æ˜¯ä¸€ä¸ªè¯­å¥ã€‚è¦ä½¿æ­¤Lambdaæœ‰æ•ˆï¼Œå¯ä»¥å»é™¤èŠ±æ‹¬å·å’Œåˆ†å·(String s) -&gt; &#123;&quot;Iron Man&quot;; &#125; (String s) -&gt; &quot;Iron Man&quot;; æ¼”ç¤ºä»£ç  1 streamæµçš„æ“ä½œ â å…ƒç´ åºåˆ—â€”â€”å°±åƒé›†åˆä¸€æ ·ï¼Œæµä¹Ÿæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå…ƒç´ ç±»å‹çš„ä¸€ç»„æœ‰åºå€¼ã€‚å› ä¸ºé›†åˆæ˜¯æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä»¥ç‰¹å®šçš„æ—¶é—´/ç©ºé—´å¤æ‚åº¦å­˜å‚¨å’Œè®¿é—®å…ƒç´ ï¼ˆå¦‚ArrayListä¸LinkedListï¼‰ã€‚ä½†æµçš„ç›®çš„åœ¨äºè¡¨è¾¾è®¡ç®—ï¼Œæ¯”å¦‚ä½ å‰é¢è§åˆ°çš„filterã€sortedå’Œmapã€‚é›†åˆè®²çš„æ˜¯æ•°æ®ï¼Œæµè®²çš„æ˜¯è®¡ç®—ã€‚åé¢å‡ èŠ‚ä¼šè¯¦ç»†è§£é‡Šè¿™ä¸ªæ€æƒ³ã€‚ â æºâ€”â€”æµä¼šä½¿ç”¨ä¸€ä¸ªæä¾›æ•°æ®çš„æºï¼Œæ¯”å¦‚é›†åˆã€æ•°ç»„æˆ–I/Oèµ„æºã€‚è¯·æ³¨æ„ï¼Œä»æœ‰åºé›†åˆç”Ÿæˆæµæ—¶ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚ç”±åˆ—è¡¨ç”Ÿæˆçš„æµï¼Œå…¶å…ƒç´ é¡ºåºä¸åˆ—è¡¨ä¸€è‡´ã€‚ â æ•°æ®å¤„ç†æ“ä½œâ€”â€”æµçš„æ•°æ®å¤„ç†åŠŸèƒ½æ”¯æŒç±»ä¼¼äºæ•°æ®åº“çš„æ“ä½œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨æ“ä½œï¼Œæ¯”å¦‚filterã€mapã€reduceã€findã€matchã€sortç­‰ã€‚æµæ“ä½œå¯ä»¥é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚ æµæ“ä½œæœ‰ä¸¤ä¸ªé‡è¦çš„ç‰¹ç‚¹ã€‚ â æµæ°´çº¿â€”â€”å¾ˆå¤šæµæ“ä½œæœ¬èº«ä¼šè¿”å›ä¸€ä¸ªæµï¼Œè¿™æ ·å¤šä¸ªæ“ä½œå°±å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œæ„æˆä¸€ä¸ªæ›´å¤§çš„æµæ°´çº¿ã€‚è¿™ä½¿å¾—ä¸€äº›ä¼˜åŒ–æˆä¸ºå¯èƒ½ï¼Œæ¯”å¦‚å¤„ç†å»¶è¿Ÿå’ŒçŸ­è·¯ã€‚æµæ°´çº¿çš„æ“ä½œå¯ä»¥çœ‹ä½œç±»ä¼¼å¯¹æ•°æ®æºè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ã€‚ â å†…éƒ¨è¿­ä»£â€”â€”ä¸é›†åˆä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œæ˜¾å¼è¿­ä»£ä¸åŒï¼Œæµçš„è¿­ä»£æ“ä½œæ˜¯åœ¨åå°è¿›è¡Œçš„ã€‚ ç¤ºä¾‹ä»£ç  12345678910List&lt;Dish&gt; menu = Arrays.asList( new Dish(&quot;pork&quot;, false, 800, Dish.Type.MEAT), new Dish(&quot;beef&quot;, false, 700, Dish.Type.MEAT), new Dish(&quot;chicken&quot;, false, 400, Dish.Type.MEAT), new Dish(&quot;french fries&quot;, true, 530, Dish.Type.OTHER), new Dish(&quot;rice&quot;, true, 350, Dish.Type.OTHER), new Dish(&quot;season fruit&quot;, true, 120, Dish.Type.OTHER), new Dish(&quot;pizza&quot;, true, 550, Dish.Type.OTHER), new Dish(&quot;prawns&quot;, false, 300, Dish.Type.FISH), new Dish(&quot;salmon&quot;, false, 450, Dish.Type.FISH) ); 1234567891011121314151617181920212223242526272829public class Dish &#123; private final String name; private final boolean vegetarian; private final int calories; private final Type type; public Dish(String name, boolean vegetarian, int calories, Type type) &#123; this.name = name; this.vegetarian = vegetarian; this.calories = calories; this.type = type; &#125; public String getName() &#123; return name; &#125; public boolean isVegetarian() &#123; return vegetarian; &#125; public int getCalories() &#123; return calories; &#125; public Type getType() &#123; return type; &#125; @Override public String toString() &#123; return name; &#125; public enum Type &#123; MEAT, FISH, OTHER &#125;&#125; åˆæ¬¡ä½¿ç”¨stream 1234567// toList()æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œéœ€è¦ import static java.util.stream.Collectors.toList;// è¦æ˜¯ä¸æƒ³å¯¼åŒ…ï¼Œå¯ä»¥æŠŠtoList() æ”¹æˆ Collectors.toList()List&lt;String&gt; collect = menu.stream().filter(dish -&gt; dish.getCalories() &gt; 300) .map(Dish::getName) .limit(3) .collect(toList());System.out.println(collect); ä¸Šè¿°ä¸­Dish::getNameç›¸å½“äºLambda d -&gt; d.getName() ç­›é€‰ï¼ˆfilterï¼‰ã€æå–ï¼ˆmapï¼‰æˆ–æˆªæ–­ï¼ˆlimitï¼‰åŠŸèƒ½ æµçš„ç‰¹æ€§ åªèƒ½éå†ä¸€é 123Stream&lt;Dish&gt; stream = menu.stream();stream.forEach(System.out::println);stream.forEach(System.out::println); å†…éƒ¨è¿­ä»£ 1234567891011121314151617// ç”¨for-eachå¾ªç¯å¤–éƒ¨è¿­ä»£ArrayList&lt;String&gt; names = new ArrayList&lt;&gt;();for (Dish dish : menu) &#123; names.add(dish.getName());&#125;/** * for-eachç»“æ„æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå…¶èƒŒåé€»è¾‘æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒIterator */ArrayList&lt;String&gt; names = new ArrayList&lt;&gt;();Iterator&lt;Dish&gt; iterator = menu.iterator();while (iterator.hasNext())&#123; names.add(iterator.next().getName());&#125;// streamçš„å†…éƒ¨è¿­ä»£List&lt;String&gt; names = menu.stream().map(Dish::getName).collect(toList());System.out.println(names); é‡æ„æµ‹è¯• 12345678List&lt;String&gt; highCaloricDishes = new ArrayList&lt;&gt;();Iterator&lt;String&gt; iterator = menu.iterator();while(iterator.hasNext()) &#123; Dish dish = iterator.next(); if(dish.getCalories() &gt; 300) &#123; highCaloricDishes.add(d.getName()); &#125;&#125; 1234List&lt;String&gt; highCaloricDishes = menu.stream() .filter(dish -&gt; dish.getCalories() &gt; 300) .collect(toList()); æµçš„æ“ä½œ ä»ä¸Šè¿°ä»£ç ä¸­,ä¸éš¾çœ‹å‡ºï¼Œstream()ä¹‹åè·Ÿç€filterï¼Œmapï¼Œlimitï¼Œcollectç­‰æ“ä½œï¼Œè¿™æ˜¯java.util.stream.Streamä¸­çš„Streamæ¥å£å®šä¹‰çš„æ“ä½œï¼Œå®ƒä»¬å¯ä»¥åˆ†æˆä¸¤ç±»ã€‚ â ä¸­é—´æ“ä½œï¼šfilterã€mapå’Œlimitå¯ä»¥è¿æˆä¸€æ¡æµæ°´çº¿ï¼› âç»ˆç«¯æ“ä½œï¼š collectè§¦å‘æµæ°´çº¿æ‰§è¡Œå¹¶å…³é—­å®ƒã€‚ æ€»ç»“ï¼š ä¸€ä¸ªæ•°æ®æº ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆæµæ°´çº¿ ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶ç”Ÿæˆç»“æœ ä¸­é—´æ“ä½œ ç±»å‹ æ“ä½œ è¿”å›ç±»å‹ æ“ä½œå‚æ•° å‡½æ•°æè¿° ä½œç”¨ filter Stream&lt;T&gt; Predicate&lt;T&gt; T -&gt; boolean ç­›é€‰ map Stream&lt;R&gt; Function&lt;T,R&gt; T -&gt; R è·å– æœ‰çŠ¶æ€-æ— ç•Œ limit Stream&lt;T&gt; æˆªé€‰ æœ‰çŠ¶æ€-æ— ç•Œ skip Stream&lt;T&gt; è·³è¿‡ æœ‰çŠ¶æ€-æ— ç•Œ sorted Stream&lt;T&gt; Comparator&lt;T&gt; (T,T) -&gt; int æœ‰çŠ¶æ€-æ— ç•Œ distinct Stream&lt;T&gt; å»é‡ ç»ˆç«¯æ“ä½œ ç±»å‹ æ“ä½œ è¿”å›ç±»å‹ ä½œç”¨ forEach void æ¶ˆè´¹æµä¸­çš„æ¯ä¸ªå…ƒç´ å¹¶å¯¹å…¶åº”ç”¨Lambda count long è¿”å›æµä¸­å…ƒç´ çš„ä¸ªæ•° collect (generic) æŠŠæµæ•´åˆæˆä¸€ä¸ªé›†åˆï¼Œæ¯”å¦‚Listï¼ŒMapï¼Œç”šè‡³æ˜¯Iterator anyMatch boolean noneMatch boolean allMatch boolean findAny Optinal&lt;T&gt; findFirst Optinal&lt;T&gt; æœ‰çŠ¶æ€-æœ‰ç•Œ reduce Optinal&lt;T&gt; ä½¿ç”¨æµ ç­›é€‰ è°“è¯ç­›é€‰ 12List&lt;Dish&gt; collect = menu.stream().filter(Dish::isVegetarian).collect(toList());System.out.println(collect); ç­›é€‰å„å¼‚çš„å…ƒç´  æµè¿˜æ”¯æŒä¸€ä¸ªå«ä½œdistinctçš„æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå…ƒç´ å„å¼‚ï¼ˆæ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„hashCodeå’Œequalsæ–¹æ³•å®ç°ï¼‰çš„æµã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šç­›é€‰å‡ºåˆ—è¡¨ä¸­æ‰€æœ‰çš„å¶æ•°ï¼Œå¹¶ç¡®ä¿æ²¡æœ‰é‡å¤ï¼ˆä½¿ç”¨equalsæ–¹æ³•è¿›è¡Œæ¯”è¾ƒ) 12345List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);numbers.stream() .filter(i -&gt; i % 2 == 0) .distinct() .forEach(System.out::println); åˆ‡ç‰‡ è°“è¯åˆ‡ç‰‡ takeWhileå’ŒdropWhileï¼Œè¿™ä¸¤ä¸ªæ˜¯java9å¼•å…¥çš„æ–°æ–¹æ³•ã€‚ å¼•å…¥åŸå› ï¼šå€˜è‹¥æ•°æ®æºå·²ç»æŒ‰ç…§çƒ­é‡ä»å°åˆ°å¤§æ’åºäº†ï¼Œè¿˜è¦ç­›é€‰å‡ºçƒ­é‡å°äº320çš„æ•°æ®ï¼Œfilterç­›é€‰ä¼šå»éå†æ‰€æœ‰æ•°æ®ï¼Œè¿™æ ·æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ã€‚æ‰€ä»¥å¼•å…¥äº†takeWhileå’ŒdropWhileã€‚ takeWhile:é€šè¿‡è°“è¯å»é€‰å–å‡ºç¬¦åˆçš„æ•°æ®ï¼Œé­é‡åˆ°ç¬¬ä¸€ä¸ªä¸ç¬¦åˆçš„å…ƒç´ æ—¶ï¼Œåœæ­¢å¤„ç† dropWhile:å’ŒtaskWhileæ˜¯ç›¸åçš„æ“ä½œï¼Œå®ƒä¼šåˆ é™¤æ‰ç¬¦åˆè¦æ±‚çš„æ•°æ® æˆªçŸ­æµ æµæ”¯æŒlimit(n)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›å¦ä¸€ä¸ªä¸è¶…è¿‡ç»™å®šé•¿åº¦çš„æµã€‚æ‰€éœ€çš„é•¿åº¦ä½œä¸ºå‚æ•°ä¼ é€’ç»™limitã€‚å¦‚æœæµæ˜¯æœ‰åºçš„ï¼Œåˆ™æœ€å¤šä¼šè¿”å›å‰nä¸ªå…ƒç´ ã€‚ è·³è¿‡å…ƒç´  æµè¿˜æ”¯æŒskip(n)æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµã€‚å¦‚æœæµä¸­å…ƒç´ ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚è¯·æ³¨æ„ï¼Œlimit(n)å’Œskip(n)æ˜¯äº’è¡¥çš„ æ˜ å°„ æµæ”¯æŒmapæ–¹æ³•ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ï¼ˆä½¿ç”¨æ˜ å°„ä¸€è¯ï¼Œæ˜¯å› ä¸ºå®ƒå’Œè½¬æ¢ç±»ä¼¼ï¼Œä½†å…¶ä¸­çš„ç»†å¾®å·®åˆ«åœ¨äºå®ƒæ˜¯â€œåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬â€è€Œä¸æ˜¯å»â€œä¿®æ”¹â€ï¼‰ æµçš„æ‰å¹³åŒ– æ¡ˆä¾‹ å¯¹äºä¸€å¼ å•è¯è¡¨ï¼Œå¦‚ä½•è¿”å›ä¸€å¼ åˆ—è¡¨ï¼Œåˆ—å‡ºé‡Œé¢å„ä¸ç›¸åŒçš„å­—ç¬¦? ä¾‹å¦‚ï¼Œç»™å®šå•è¯åˆ—è¡¨[â€œHelloâ€,â€œWorldâ€]ï¼Œè¦è¿”å›åˆ—è¡¨[â€œHâ€, â€œeâ€, â€œlâ€, â€œoâ€, â€œWâ€, â€œrâ€, â€œdâ€] å°è¯•1ï¼šä¸è¡Œ 1234567List&lt;String&gt; words = Arrays.asList(&quot;hello&quot;, &quot;world&quot;);List&lt;String[]&gt; collect = words.stream() .map(word -&gt; word.split(&quot;&quot;)) .distinct() .collect(toList());System.out.println(&quot;words = &quot; + words); å°è¯•2ï¼šä¸è¡Œ 12345678List&lt;String&gt; words = Arrays.asList(&quot;hello&quot;, &quot;world&quot;);List&lt;Stream&lt;String&gt;&gt; collect = words.stream() .map(word -&gt; word.split(&quot;&quot;)) .map(Arrays::stream) .distinct() .collect(toList());System.out.println(&quot;words = &quot; + words); è§£é‡ŠArrays::streamï¼š 1234String[] arrayOfWords = &#123;&quot;Goodbye&quot;, &quot;World&quot;&#125;;List&lt;String&gt; streamOfwords = Arrays .stream(arrayOfWords) // è¿™æ˜¯Stream&lt;String&gt;ç±»å‹çš„ .collect(toList()); å°è¯•3ï¼šä½¿ç”¨flatMap,æˆåŠŸ flatMap 12345678List&lt;String&gt; words = Arrays.asList(&quot;hello&quot;, &quot;world&quot;);List&lt;String&gt; collect = words.stream() .map(word -&gt; word.split(&quot;&quot;)) .flatMap(Arrays::stream) .distinct() .collect(toList());System.out.println(&quot;words = &quot; + words); æŸ¥æ‰¾å’ŒåŒ¹é… å¦ä¸€ä¸ªå¸¸è§çš„æ•°æ®å¤„ç†å¥—è·¯æ˜¯çœ‹çœ‹æ•°æ®é›†ä¸­çš„æŸäº›å…ƒç´ æ˜¯å¦åŒ¹é…ä¸€ä¸ªç»™å®šçš„å±æ€§ã€‚Stream APIé€šè¿‡allMatchã€anyMatchã€noneMatchã€findFirstå’ŒfindAnyæ–¹æ³•æä¾›äº†è¿™æ ·çš„å·¥å…·ã€‚ anyMatch anyMatchæ–¹æ³•å¯ä»¥å›ç­”â€œæµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ èƒ½åŒ¹é…ç»™å®šçš„è°“è¯â€ æ¯”å¦‚â†“ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥çœ‹çœ‹èœå•é‡Œé¢æ˜¯å¦æœ‰ç´ é£Ÿå¯é€‰æ‹© 1234if(menu.stream().anyMatch(Dish::isVegetarian))&#123; System.out.println(&quot;The menu is (somewhat) vegetarian friendly! ! &quot;);&#125;//anyMatchæ–¹æ³•è¿”å›ä¸€ä¸ªboolean allMatch allMatchæ–¹æ³•ä¼šçœ‹æµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚ æ¯”å¦‚â†“ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥çœ‹çœ‹èœå“æ˜¯å¦æœ‰åˆ©å¥åº·ï¼ˆå³æ‰€æœ‰èœçš„çƒ­é‡éƒ½ä½äº1000å¡è·¯é‡Œï¼‰ï¼š 1boolean isHealthy = menu.stream().allMatch(dish -&gt; dish.getCalories() &lt; 1000); noneMatch å®ƒå¯ä»¥ç¡®ä¿æµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ä¸ç»™å®šçš„è°“è¯åŒ¹é… æ¯”å¦‚â†“ï¼Œä½ å¯ä»¥ç”¨noneMatché‡å†™å‰é¢çš„ä¾‹å­ 1boolean isHealthy = menu.stream().noneMatch(dish -&gt; dish.getCalories() &gt;= 1000); findAny findAnyæ–¹æ³•å°†è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ ã€‚å®ƒå¯ä»¥ä¸å…¶ä»–æµæ“ä½œç»“åˆä½¿ç”¨ æ¯”å¦‚â†“ï¼Œä½ å¯èƒ½æƒ³æ‰¾åˆ°ä¸€é“ç´ é£Ÿèœè‚´ã€‚å¯ä»¥ç»“åˆä½¿ç”¨filterå’ŒfindAnyæ–¹æ³•æ¥å®ç°è¿™ä¸ªæŸ¥è¯¢ Optional 1Optional&lt;Dish&gt; dish = menu.stream().filter(Dish::isVegetarian).findAny(); findFirst æœ‰äº›æµç”±ä¸€ä¸ªå‡ºç°é¡ºåºï¼ˆencounter orderï¼‰æ¥æŒ‡å®šæµä¸­é¡¹ç›®å‡ºç°çš„é€»è¾‘é¡ºåºï¼ˆæ¯”å¦‚ç”±Listæˆ–æ’åºå¥½çš„æ•°æ®åˆ—ç”Ÿæˆçš„æµï¼‰ã€‚å¯¹äºè¿™ç§æµï¼Œä½ å¯èƒ½æƒ³è¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ä¸ºæ­¤æœ‰ä¸€ä¸ªfindFirstæ–¹æ³•ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºfindAny 123456List&lt;Integer&gt; someNumbers = Arrays.asList(1, 2, 3, 4, 5);Optional&lt;Integer&gt; firstSquareDivisibleByThree = someNumbers.stream() .map(n -&gt; n * n) .filter(n -&gt; n % 3 == 0) .findFirst(); // 9 å½’çº¦-reduce æ­¤ç±»æŸ¥è¯¢éœ€è¦å°†æµä¸­æ‰€æœ‰å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚ä¸€ä¸ªIntegerã€‚è¿™æ ·çš„æŸ¥è¯¢å¯ä»¥è¢«å½’ç±»ä¸ºå½’çº¦æ“ä½œï¼ˆå°†æµå½’çº¦æˆä¸€ä¸ªå€¼ï¼‰ã€‚ç”¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„æœ¯è¯­æ¥è¯´ï¼Œè¿™ç§°ä¸ºæŠ˜å ï¼ˆfoldï¼‰ï¼Œå› ä¸ºä½ å¯ä»¥å°†è¿™ä¸ªæ“ä½œçœ‹æˆæŠŠä¸€å¼ é•¿é•¿çš„çº¸ï¼ˆä½ çš„æµï¼‰åå¤æŠ˜å æˆä¸€ä¸ªå°æ–¹å—ï¼Œè€Œè¿™å°±æ˜¯æŠ˜å æ“ä½œçš„ç»“æœ æ±‚å’Œ åœ¨ç ”ç©¶å¦‚ä½•ä½¿ç”¨reduceæ–¹æ³•ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨for-eachå¾ªç¯æ¥å¯¹æ•°å­—åˆ—è¡¨ä¸­çš„å…ƒç´ æ±‚å’Œ 1234int sum = 0;for (int x : numbers) &#123; sum += x;&#125; ä»ä¸Šè¿°ä»£ç çœ‹ï¼Œfor-eachçš„æ±‚å’Œè¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦å¼•å…¥reduceå‘¢ï¼Ÿ for-eachä»£ç å¤ç”¨ç‡ä½ï¼Œreduceå¯¹é‡å¤åº”ç”¨çš„æ¨¡å¼åšäº†æŠ½è±¡ 12// å¼•å…¥reduceæ±‚å’Œint sum = numbers.stream().reduce(0,(a,b)-&gt;a+b); reduceæ¥æ”¶çš„å‚æ•°ï¼š åˆå§‹å€¼ï¼Œå³å¯¹åº”for-eachä¸­çš„sum BinaryOperator&lt;T&gt;ç”¨æ¥å°†ä¸¤ä¸ªå…ƒç´ ç»“åˆèµ·æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å€¼ã€‚ä¸Šè¿°ä»£ç ä¸­æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ (a,b)-&gt;a+b æ‰€ä»¥ï¼Œå½“æœ‰ç´¯ä¹˜çš„ä¸šåŠ¡æ—¶ï¼Œæˆ‘ä»¬å¯ä¹Ÿå†™æˆï¼š 1int product = numbers.stream().reduce(1,(a,b)-&gt;a*b); å¼•å…¥java8é™æ€æ–¹æ³•sumè¿›è¡Œæ±‚å’Œ 1int sum = numbers.stream().reduce(0,Integer::sum); æ— åˆå§‹å€¼ reduceè¿˜æœ‰ä¸€ä¸ªé‡è½½çš„å˜ä½“ï¼Œå®ƒä¸æ¥å—åˆå§‹å€¼ï¼Œä½†æ˜¯ä¼šè¿”å›ä¸€ä¸ªOptionalå¯¹è±¡ 1int sum = numbers.stream().reduce((a,b)-&gt;a+b); æœ€å¤§å€¼å’Œæœ€å°å€¼ 12Optional&lt;Integer&gt; max = numbers.stream().reduce(Integer::max);Optional&lt;Integer&gt; min = numbers.stream().reduce(Integer::min); å½’çº¦æ–¹æ³•çš„ä¼˜åŠ¿ä¸å¹¶è¡ŒåŒ– ä»for-eachå¾ªç¯æ±‚å’Œæ¥çœ‹ï¼Œè¿™ç§è¿­ä»£æ±‚å’Œæ–¹å¼ä¸€æ—¦å¹¶è¡Œï¼Œé—®é¢˜æ—¶è‡´å‘½çš„ã€‚è€Œreduceæä¾›äº†æ›´åŠ å®‰å…¨ï¼Œç®€ä¾¿çš„å®ç°æ–¹å¼ã€‚ 123// use stream to sum all elements in parallel// ä½¿ç”¨æµå¯¹æ‰€æœ‰å…ƒç´ å¹¶è¡Œæ±‚å’Œint sum = numbers.parallelStream().reduce(0,Integer::sum); åŸå§‹ç±»å‹æµç‰¹åŒ– 1int calories = menu.stream().map(Dish::getCalories).reduce(0, Integer::sum); åƒä¸Šè¿°ä»£ç ï¼Œç›´æ¥å†™æˆint calories = menu.stream().map(Dish::getCalories).sum();ä¸æ˜¯æ›´å¥½ï¼Ÿä½†è¿™å´æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºmapæ–¹æ³•ç”Ÿæˆçš„æ˜¯Stream&lt;T&gt;ç±»å‹çš„æ•°æ®ï¼Œæ²¡åŠæ³•é€šè¿‡sum()æ–¹æ³•æ¥å®ç°æ±‚å’Œï¼Œä¸è¿‡Stream APIæä¾›äº†åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼Œä¸“é—¨å¤„ç†æ•°å€¼æµçš„æ–¹æ³• IntStreamã€DoubleStreamå’ŒLongStreamï¼Œåˆ†åˆ«å°†æµä¸­çš„å…ƒç´ ç‰¹åŒ–ä¸ºintã€longå’Œdoubleï¼Œä»è€Œé¿å…äº†æš—å«çš„è£…ç®±æˆæœ¬ æ˜ å°„åˆ°æ•°å€¼æµ å°†æµè½¬æ¢ä¸ºç‰¹åŒ–ç‰ˆæœ¬çš„å¸¸ç”¨æ–¹æ³•æ˜¯mapToIntã€mapToDoubleå’ŒmapToLong è¿™äº›æ–¹æ³•å’Œå‰é¢è¯´çš„mapæ–¹æ³•çš„å·¥ä½œæ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯å®ƒä»¬è¿”å›çš„æ˜¯ä¸€ä¸ªç‰¹åŒ–æµï¼Œè€Œä¸æ˜¯Stream IntStreamè¿˜æ”¯æŒå…¶ä»–çš„æ–¹ä¾¿æ–¹æ³•ï¼Œå¦‚maxã€minã€averageç­‰ 1234int sum = menu.stream() //Stream&lt;Dish&gt; .mapToInt(Dish::getCalories) // IntStream .sum(); // å¦‚æœIntStreamæ˜¯ç©ºçš„è¯ï¼Œè¿”å›çš„æ˜¯0 è½¬æ¢å›å¯¹è±¡æµ åŒæ ·ï¼Œä¸€æ—¦æœ‰äº†æ•°å€¼æµï¼Œä½ å¯èƒ½ä¼šæƒ³æŠŠå®ƒè½¬æ¢å›éç‰¹åŒ–æµã€‚ä¾‹å¦‚ï¼ŒIntStreamä¸Šçš„æ“ä½œåªèƒ½äº§ç”ŸåŸå§‹æ•´æ•°ï¼šIntStreamçš„mapæ“ä½œæ¥å—çš„Lambdaå¿…é¡»æ¥å—intå¹¶è¿”å›intï¼ˆä¸€ä¸ªIntUnaryOperatorï¼‰ã€‚ä½†æ˜¯ä½ å¯èƒ½æƒ³è¦ç”Ÿæˆå¦ä¸€ç±»å€¼ï¼Œæ¯”å¦‚Dish 123IntStream intStream = menu.stream() .mapToInt(Dish::getCalories);Stream&lt;Integer&gt; stream = intStream.boxed(); é»˜è®¤å€¼OptionalInt æ±‚å’Œçš„é‚£ä¸ªä¾‹å­å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ªé»˜è®¤å€¼ï¼š0ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ è¦è®¡ç®—IntStreamä¸­çš„æœ€å¤§å…ƒç´ ï¼Œå°±å¾—æ¢ä¸ªæ³•å­äº†ï¼Œå› ä¸º0æ˜¯é”™è¯¯çš„ç»“æœ Optionalç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨çš„å®¹å™¨ã€‚Optionalå¯ä»¥ç”¨Integerã€Stringç­‰å‚è€ƒç±»å‹æ¥å‚æ•°åŒ–ã€‚å¯¹äºä¸‰ç§åŸå§‹æµç‰¹åŒ–ï¼Œä¹Ÿåˆ†åˆ«æœ‰ä¸€ä¸ªOptionalåŸå§‹ç±»å‹ç‰¹åŒ–ç‰ˆæœ¬ï¼šOptionalIntã€OptionalDoubleå’ŒOptionalLong 123456OptionalInt maxCalories = menu.stream() .mapToInt(Dish::getCalories) .max();System.out.println(&quot;maxCalories = &quot; + maxCalories);int max = maxCalories.orElse(1); æ•°å€¼èŒƒå›´ 123456789IntStream.range(1, 10) .filter(value -&gt; value % 2 == 0) .forEach(System.out::println); // â†‘ç»“æœï¼š2ï¼Œ4ï¼Œ6ï¼Œ8IntStream.rangeClosed(1, 10) .filter(value -&gt; value % 2 == 0) .forEach(System.out::println); // â†‘ç»“æœï¼š2ï¼Œ4ï¼Œ6ï¼Œ8ï¼Œ10 // æ€»ç»“rangeèŒƒå›´[x,y),rangeClosedèŒƒå›´[x,y] å°è¯•ï¼šè·å–å‹¾è‚¡æ•° 123456789101112131415161718192021Stream&lt;int[]&gt; pythagoreanTriples = IntStream.rangeClosed(1, 100).boxed() .flatMap(a -&gt; IntStream.rangeClosed(a, 100) .filter(b -&gt; Math.sqrt(a*a + b*b) % 1 == 0) .mapToObj( b -&gt; new int[]&#123;a, b, (int)Math.sqrt(a * a + b * b)&#125;) );pythagoreanTriples.limit(5).forEach(t-&gt;System.out.println(t[0]+&quot;,&quot;+ t[1] + &quot;,&quot; + t[2]));Stream&lt;double[]&gt; pythagoreanTriples = IntStream.rangeClosed(1, 100).boxed() .flatMap(a -&gt; IntStream.rangeClosed(a, 100) .mapToObj( b -&gt; new double[]&#123;a, b, Math.sqrt(a * a + b * b)&#125;) ) .filter(t -&gt; t[2] % 1 == 0);pythagoreanTriples.limit(5).forEach(t-&gt;System.out.println(t[0]+&quot;,&quot;+ t[1] + &quot;,&quot; + t[2])); Optionalç®€ä»‹ Optional&lt;T&gt;ç±»ï¼ˆjava.util.Optionalï¼‰æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ã€‚ åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒfindAnyå­˜åœ¨ä»€ä¹ˆå…ƒç´ éƒ½æ²¡æœ‰æ‰¾åˆ°çš„å¯èƒ½ï¼Œæ‰€ä»¥java8å¼•å…¥äº†Optional&lt;T&gt;,ç”¨æ¥é¿å…è¿”å›nullçš„é—®é¢˜ æµ‹è¯• æµ‹è¯•1ï¼šfilter æ ¹æ®ç¤ºä¾‹ä»£ç ï¼Œç»“åˆfilterä½¿ç”¨æµç­›é€‰å‡ºå‰ä¸¤ä¸ªè¤èœ 12345List&lt;Dish&gt; collect = menu.stream() .filter(dish -&gt; dish.getType().equals(Dish.Type.MEAT)) .limit(2) .collect(toList()); æµ‹è¯•2ï¼šmap æ ¹æ®ç¤ºä¾‹ä»£ç ï¼Œç»“åˆæ˜ å°„ (1)ç»™å®šä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œå¦‚ä½•è¿”å›ä¸€ä¸ªç”±æ¯ä¸ªæ•°çš„å¹³æ–¹æ„æˆçš„åˆ—è¡¨å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç»™å®š[1, 2, 3, 4, 5]ï¼Œåº”è¯¥è¿”å›[1, 4, 9, 16,25]ã€‚ (2) ç»™å®šä¸¤ä¸ªæ•°å­—åˆ—è¡¨ï¼Œå¦‚ä½•è¿”å›æ‰€æœ‰çš„æ•°å¯¹å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç»™å®šåˆ—è¡¨[1, 2, 3]å’Œåˆ—è¡¨[3, 4]ï¼Œåº”è¯¥è¿”å›[(1, 3), (1, 4), (2, 3), (2,4), (3, 3), (3, 4)]ã€‚ä¸ºç®€å•èµ·è§ï¼Œä½ å¯ä»¥ç”¨æœ‰ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„æ¥ä»£è¡¨æ•°å¯¹ (3) å¦‚ä½•æ‰©å±•å‰ä¸€ä¸ªä¾‹å­ï¼Œåªè¿”å›æ€»å’Œèƒ½è¢«3æ•´é™¤çš„æ•°å¯¹ 12345// (1)ç»™å®šä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œå¦‚ä½•è¿”å›ä¸€ä¸ªç”±æ¯ä¸ªæ•°çš„å¹³æ–¹æ„æˆçš„åˆ—è¡¨å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç»™å®š[1, 2, 3, 4, 5]ï¼Œåº”è¯¥è¿”å›[1, 4, 9, 16,25]ã€‚List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4, 5);List&lt;Integer&gt; collect = numbers.stream().map(n -&gt; n * n) .collect(toList());System.out.println(&quot;collect = &quot; + collect); 123456789// (2)ç»™å®šä¸¤ä¸ªæ•°å­—åˆ—è¡¨ï¼Œå¦‚ä½•è¿”å›æ‰€æœ‰çš„æ•°å¯¹å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç»™å®šåˆ—è¡¨[1, 2, 3]å’Œåˆ—è¡¨[3, 4]ï¼Œåº”è¯¥è¿”å›[(1, 3), (1, 4), (2, 3), (2,4), (3, 3), (3, 4)]ã€‚ä¸ºç®€å•èµ·è§ï¼Œä½ å¯ä»¥ç”¨æœ‰ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„æ¥ä»£è¡¨æ•°å¯¹List&lt;Integer&gt; numbers1 = Arrays.asList(1, 2, 3);List&lt;Integer&gt; numbers2 = Arrays.asList(3, 4);List&lt;int[]&gt; pairs = numbers1.stream() .flatMap(i -&gt; numbers2.stream() .map(j -&gt; new int[]&#123;i, j&#125;) ) .collect(toList()); 1234567891011// (3)å¦‚ä½•æ‰©å±•å‰ä¸€ä¸ªä¾‹å­ï¼Œåªè¿”å›æ€»å’Œèƒ½è¢«3æ•´é™¤çš„æ•°å¯¹List&lt;Integer&gt; numbers1 = Arrays.asList(1, 2, 3);List&lt;Integer&gt; numbers2 = Arrays.asList(3, 4);List&lt;int[]&gt; pairs = numbers1.stream() .flatMap(i -&gt; numbers2.stream() .filter(j -&gt; (i + j) % 3 == 0) .map(j -&gt; new int[]&#123;i, j&#125;) ) .collect(toList()); æµ‹è¯•3ï¼šreduce æ ¹æ®ç¤ºä¾‹ä»£ç ï¼Œç»“åˆreduceï¼Œæ•°ä¸€æ•°æµä¸­æœ‰å¤šå°‘ä¸ªèœ 1int count = menu.stream().map(d -&gt; 1).reduce(0, (a, b) -&gt; a + b); ç­‰ä»·äº 1long count = menu.stream().count(); ç»¼åˆæµ‹è¯• æºä»£ç  123456789101112Trader raoul = new Trader(&quot;Raoul&quot;, &quot;Cambridge&quot;);Trader mario = new Trader(&quot;Mario&quot;, &quot;Milan&quot;);Trader alan = new Trader(&quot;Alan&quot;, &quot;Cambridge&quot;);Trader brian = new Trader(&quot;Brian&quot;, &quot;Cambridge&quot;);List&lt;Transaction&gt; transactions = Arrays.asList( new Transaction(brian, 2011, 300), new Transaction(raoul, 2012, 1000), new Transaction(raoul, 2011, 400), new Transaction(mario, 2012, 710), new Transaction(mario, 2012, 700), new Transaction(alan, 2012, 950)); 1234567891011121314151617181920212223242526272829303132333435363738394041public class Trader&#123; private final String name; private final String city; public Trader(String n, String c)&#123; this.name = n; this.city = c; &#125; public String getName()&#123; return this.name; &#125; public String getCity()&#123; return this.city; &#125; public String toString()&#123; return &quot;Trader:&quot;+this.name + &quot; in &quot; + this.city; &#125;&#125;public class Transaction&#123; private final Trader trader; private final int year; private final int value; public Transaction(Trader trader, int year, int value)&#123; this.trader = trader; this.year = year; this.value = value; &#125; public Trader getTrader()&#123; return this.trader; &#125; public int getYear()&#123; return this.year; &#125; public int getValue()&#123; return this.value; &#125; public String toString()&#123; return &quot;&#123;&quot; + this.trader + &quot;, &quot; + &quot;year: &quot;+this.year+&quot;, &quot; + &quot;value:&quot; + this.value +&quot;&#125;&quot;; &#125;&#125; é—®é¢˜ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162// (1) æ‰¾å‡º2011å¹´å‘ç”Ÿçš„æ‰€æœ‰äº¤æ˜“ï¼Œå¹¶æŒ‰äº¤æ˜“é¢æ’åºï¼ˆä»ä½åˆ°é«˜ï¼‰ã€‚ List&lt;Transaction&gt; tr2011 = transactions.stream() .filter(transaction -&gt; transaction.getYear() == 2011) .sorted(Comparator.comparing(Transaction::getValue)) .collect(Collectors.toList()); System.out.println(&quot;tr2011 = &quot; + tr2011);// (2) äº¤æ˜“å‘˜éƒ½åœ¨å“ªäº›ä¸åŒçš„åŸå¸‚å·¥ä½œè¿‡ï¼Ÿ List&lt;String&gt; cities = transactions.stream() .map(transaction -&gt; transaction.getTrader().getCity()) .distinct() .collect(Collectors.toList());// Set&lt;String&gt; cities = transactions.stream()// .map(transaction -&gt; transaction.getTrader().getCity())// .collect(Collectors.toSet());// System.out.println(&quot;cities = &quot; + cities); System.out.println(&quot;cities = &quot; + cities);// (3) æŸ¥æ‰¾æ‰€æœ‰æ¥è‡ªäºå‰‘æ¡¥çš„äº¤æ˜“å‘˜ï¼Œå¹¶æŒ‰å§“åæ’åºã€‚ List&lt;Trader&gt; cambridgeTrader = transactions.stream() .map(Transaction::getTrader) .filter(trader -&gt; trader.getCity().equals(&quot;Cambridge&quot;)) .distinct() .sorted(Comparator.comparing(Trader::getName)) .collect(Collectors.toList()); System.out.println(&quot;cambridgeTrader = &quot; + cambridgeTrader);// (4) è¿”å›æ‰€æœ‰äº¤æ˜“å‘˜çš„å§“åå­—ç¬¦ä¸²ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åºã€‚// String reduce = transactions.stream()// .map(transaction -&gt; transaction.getTrader().getName())// .distinct()// .sorted()// .reduce(&quot;&quot;, (n1, n2) -&gt; n1 + n2); String reduce = transactions.stream() .map(transaction -&gt; transaction.getTrader().getName()) .distinct() .sorted() .collect(Collectors.joining()); System.out.println(&quot;reduce = &quot; + reduce);// (5) æœ‰æ²¡æœ‰äº¤æ˜“å‘˜æ˜¯åœ¨ç±³å…°å·¥ä½œçš„ï¼Ÿ boolean anyOneInMilan = transactions.stream() .anyMatch(transaction -&gt; transaction.getTrader().getCity().equals(&quot;Milan&quot;)); System.out.println(&quot;anyOneInMilan = &quot; + anyOneInMilan);// (6) æ‰“å°ç”Ÿæ´»åœ¨å‰‘æ¡¥çš„äº¤æ˜“å‘˜çš„æ‰€æœ‰äº¤æ˜“é¢ã€‚ transactions.stream() .filter(transaction -&gt; transaction.getTrader().getCity().equals(&quot;Cambridge&quot;)) .map(Transaction::getValue) .forEach(System.out::println);// (7) æ‰€æœ‰äº¤æ˜“ä¸­ï¼Œæœ€é«˜çš„äº¤æ˜“é¢æ˜¯å¤šå°‘ï¼Ÿ Optional&lt;Integer&gt; max = transactions.stream() .map(Transaction::getValue) .reduce(Integer::max); Optional&lt;Transaction&gt; max1 = transactions.stream().max(Comparator.comparing(Transaction::getValue)); System.out.println(&quot;max = &quot; + max); System.out.println(&quot;max1 = &quot; + max1);// (8) æ‰¾åˆ°äº¤æ˜“é¢æœ€å°çš„äº¤æ˜“ã€‚ Optional&lt;Integer&gt; min = transactions.stream() .map(Transaction::getValue) .reduce(Integer::min); Optional&lt;Transaction&gt; min1 = transactions.stream().min(Comparator.comparing(Transaction::getValue)); System.out.println(&quot;min = &quot; + min); System.out.println(&quot;min1 = &quot; + min1); æµ‹è¯•æ ‘å½¢æ•°æ® 1234567891011121314151617181920212223242526272829303132333435public static void main(String[] args) &#123; ArrayList&lt;Zz&gt; source = new ArrayList&lt;&gt;(); for (int i = 1; i &lt; 10; i++) &#123; Zz z1 = new Zz(); z1.setId(Long.valueOf(i)); int i1 = i % 3 == 2 ? i - 1 : 0; z1.setPid(Long.valueOf(i1)); source.add(z1); &#125; System.out.println(source); List&lt;Zz&gt; tree = source.stream() .filter(item -&gt; item.getPid().equals(0)) .map(item -&gt; &#123; List&lt;Zz&gt; children = new ArrayList&lt;&gt;(); item.setChildren(children); getChildren(children, item.getId(), source); return item; &#125;) .collect(Collectors.toList()); System.out.println(tree);&#125;private static void getChildren(List&lt;Zz&gt; children, Long id, ArrayList&lt;Zz&gt; source) &#123; source.stream() .filter(item -&gt; item.getPid().equals(id)) .map(item -&gt; &#123; children.add(item); List&lt;Zz&gt; child = new ArrayList&lt;&gt;(); item.setChildren(child); getChildren(children, item.getId(), source); return item; &#125;) .collect(Collectors.toList());&#125; å‡½æ•°å¼ç¼–ç¨‹Function å¾…ç»­","categories":[{"name":"Java","slug":"Java","permalink":"https://solitaire-12.github.io/categories/Java/"}],"tags":[{"name":"Java8","slug":"Java8","permalink":"https://solitaire-12.github.io/tags/Java8/"}]},{"title":"Java|JVM","slug":"Java/JVM","date":"2024-03-18T12:10:55.000Z","updated":"2024-03-19T00:38:37.182Z","comments":true,"path":"2024/03/18/Java/JVM/","permalink":"https://solitaire-12.github.io/2024/03/18/Java/JVM/","excerpt":"","text":"ç±»åŠ è½½ åŠ è½½è¿‡ç¨‹ å°†javaæ–‡ä»¶ç¼–è¯‘æˆclasså­—èŠ‚ç æ–‡ä»¶ï¼Œé€šè¿‡ç±»åŠ è½½å™¨å†™å…¥åˆ°JVMè™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºä¸­ã€‚ ç±»åŠ è½½æµç¨‹ â€‹ ç±»åŠ è½½éœ€è¦ç»å†äº”ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯åŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œè§£æï¼Œåˆå§‹åŒ–ã€‚å…¶ä¸­åŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œåˆå§‹åŒ–è¿™å››ä¸ªé˜¶æ®µå‘ç”Ÿçš„é¡ºåºæ—¶ç¡®å®šçš„ï¼Œè€Œè§£æé˜¶æ®µæ—¶ä¸ä¸€å®šçš„ã€‚å®ƒåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒjavaçš„è¿è¡Œæ—¶ç»‘å®šï¼ˆä¹Ÿç§°åšåŠ¨æ€ç»‘å®šï¼‰ã€‚å¦å¤–ï¼Œè¿™äº›é˜¶æ®µéƒ½æ˜¯æŒ‰é¡ºåºå¼€å§‹ï¼Œè€ŒéæŒ‰é¡ºåºè¿›è¡Œæˆ–è€…å®Œæˆã€‚ ç±»åŠ è½½å™¨ åŒäº²å§”æ´¾æœºåˆ¶ï¼š â€‹ å½“æŸä¸ªç±»åŠ è½½å™¨éœ€è¦åŠ è½½æŸä¸ªclassæ–‡ä»¶æ—¶ï¼Œå®ƒé¦–å…ˆä¼šæŠŠè¿™ä¸ªä»»åŠ¡å§”æ´¾ç»™å®ƒçš„çˆ¶çº§åŠ è½½å™¨ï¼Œé€’å½’åˆ°é¡¶çº§åŠ è½½å™¨ã€‚éšåè¿›è¡ŒåŠ è½½ï¼Œå€˜è‹¥åŠ è½½å¤±è´¥ï¼Œç”±å­ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ã€‚å¯ä»¥ä¿è¯åŒä¸€ä¸ªclassåªè¢«åŠ è½½ä¸€æ¬¡ã€‚ è¿è¡Œæ—¶æ•°æ®åŒº ç»¿è‰²çº¿ç¨‹å…±äº«ï¼Œè“è‰²çº¿ç¨‹ç§æœ‰ JDK6ï¼šæœ‰æ°¸ä¹…ä»£ï¼Œé™æ€å˜é‡å­˜æ”¾åœ¨æ°¸ä¹…ä»£ä¸Š JDK7ï¼šæœ‰æ°¸ä¹…ä»£ï¼Œä½†æ˜¯å·²ç»æŠŠè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå¸¸é‡æ± å­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­äº†ï¼Œé€æ¸çš„å‡å°‘æ°¸ä¹…ä»£çš„ä½¿ç”¨ã€‚ JDK8ï¼šæ— æ°¸ä¹…ä»£ï¼Œè¿è¡Œæ˜¯å¸¸é‡æ± ã€ç±»å¸¸é‡æ± éƒ½ä¿å­˜åœ¨å…ƒæ•°æ®åŒºï¼Œä¹Ÿå°±æ˜¯å…ƒç©ºé—´ ã€‚ä½†æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ± ä»»ç„¶æ”¾åœ¨å †ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå…ƒç©ºé—´å ç”¨çš„æ˜¯æœ¬åœ°å†…å­˜ã€‚ å†…å­˜æ¨¡å‹ ç¨‹åºè®¡æ•°å™¨ çº¿ç¨‹ç§æœ‰ã€‚Javaè™šæ‹Ÿæœºæ‰§è¡Œå¤šçº¿ç¨‹æ—¶ï¼Œç”±äºCPUæ—¶é—´ç‰‡é™åˆ¶ï¼Œçº¿ç¨‹æ‰§è¡Œå…·æœ‰éšæœºæ€§ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸€ç›´åˆ‡æ¢æ‰§è¡Œä¸åŒæŒ‡ä»¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠåˆ‡æ¢æ—¶å€™çº¿ç¨‹æ‰§è¡Œçš„ä½ç½®å­˜å…¥åˆ°PCå¯„å­˜å™¨ä¸­ï¼Œç­‰åˆ‡å›æ¥çš„æ—¶å€™èƒ½å¤Ÿå›åˆ°åŸæ¥çš„ä½ç½®ç»§ç»­æ‰§è¡Œã€‚ ä»»ä½•æ—¶å€™ï¼Œæ¯ä¸ªJavaè™šæ‹Ÿæœºéƒ½åœ¨æ‰§è¡Œå•ä¸ªæ–¹æ³•çš„ä»£ç ï¼Œå³è¯¥çº¿ç¨‹çš„å½“å‰æ–¹æ³•ã€‚å¦‚æœè¯¥æ–¹æ³•ä¸æ˜¯Nativeæ–¹æ³•ï¼Œå³PCå¯„å­˜å™¨ä¼šè®°å½•å½“å‰æ­£åœ¨æ‰§è¡Œçš„javaè™šæ‹ŸæœºæŒ‡ä»¤çš„åœ°å€ï¼Œå¦‚æœçº¿ç¨‹å½“å‰æ‰§è¡Œçš„æ–¹æ³•æ˜¯æœ¬åœ°çš„ï¼Œé‚£ä¹ˆjavaè™šæ‹Ÿæœºçš„PCå¯„å­˜å™¨çš„å€¼å°±æ˜¯Undefinedã€‚ ç¨‹åºè®¡æ•°å™¨æ˜¯å”¯ä¸€ä¸€ä¸ªä¸ä¼šå‡ºç°OOMçš„åŒºåŸŸã€‚ æœ¬åœ°æ–¹æ³•æ ˆ çº¿ç¨‹ç§æœ‰ã€‚æä¾›è™šæ‹Ÿæœºä½¿ç”¨åˆ°æœ¬åœ°Nativeæ–¹æ³•ï¼Œæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåœ¨æœ‰çš„è™šæ‹Ÿæœºæ˜¯åˆåœ¨ä¸€èµ·çš„ï¼Œä¾‹å¦‚Hot Spotè™šæ‹Ÿæœºã€‚ æ ˆ çº¿ç¨‹ç§æœ‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¸çº¿ç¨‹åŒæ—¶åˆ›å»ºçš„ç§æœ‰çš„è™šæ‹Ÿæœºæ ˆã€‚è™šæ‹Ÿæœºæ ˆä¸­å­˜å‚¨æ ˆå¸§ï¼Œæ¯ä¸ªè¢«çº¿ç¨‹è°ƒç”¨çš„æ–¹æ³•éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ ˆå¸§ï¼Œæ ˆå¸§ä¸­ä¿å­˜ä¸€ä¸ªæ–¹æ³•çš„çŠ¶æ€ä¿¡æ¯ï¼Œä¾‹å¦‚å±€éƒ¨å˜é‡(å­˜å‚¨æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡)ã€æ“ä½œæ•°å¸§(ç”¨æ¥è®¡ç®—ä¸´æ—¶å­˜æ”¾å˜é‡)ã€æ–¹æ³•å‡ºå£(è®°å½•å“ªä¸ªæ–¹æ³•çš„æœ¬æ–¹æ³•)ã€åŠ¨æ€é“¾æ¥(å­˜æ”¾æ–¹æ³•çš„å…ƒä¿¡æ¯)ç­‰ã€‚è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±æ˜¯æ‰§è¡Œä¸€ä¸ªæ ˆå¸§çš„è¿‡ç¨‹ï¼Œä¸€ä¸ªæ–¹æ³•è°ƒç”¨å®Œæˆï¼Œå¯¹åº”çš„æ ˆå¸§å°±ä¼šå‡ºæ ˆã€‚ å¦‚æœçº¿ç¨‹æ‰§è¡Œæ‰€éœ€æ ˆæ·±åº¦å¤§äºJavaè™šæ‹Ÿæœºæ ˆæ·±åº¦ï¼Œå°±ä¼šæŠ›å‡ºStackOverFlowErrorï¼Œå…¶å®æ–¹æ³•è°ƒç”¨çš„è¿‡ç¨‹å°±æ˜¯å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ï¼Œå¦‚æœä¸€è‡´å…¥æ ˆä¸å‡ºæ ˆï¼Œå°±å®¹æ˜“å‘ç”Ÿå¼‚å¸¸ï¼ˆé€’å½’è°ƒç”¨ï¼‰ å¦‚æœJavaè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œä½†æ˜¯æ‰©å±•å¤§å°çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorã€‚ å † çº¿ç¨‹å…±äº«ã€‚å †æ˜¯javaè™šæ‹Ÿæœºç®¡ç†å†…å­˜æœ€å¤§çš„ä¸€å—ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå †ä¸­çš„å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«æ˜¾å¼é‡Šæ”¾ï¼Œå¿…é¡»ç”±GCå›æ”¶ï¼Œæ‰€ä»¥GCä¹Ÿä¸»è¦å›æ”¶å †ä¸­çš„å¯¹è±¡å®ä¾‹ï¼Œæˆ‘ä»¬å¹³å¸¸è®¨è®ºçš„åƒåœ¾å›æ”¶å°±æ˜¯å›æ”¶å †å†…å­˜ã€‚å †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„ç©ºé—´ï¼Œå¯ä»¥å›ºå®šå¤§å°ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œé€šè¿‡å‚æ•°-Xmså’Œ-Xmxä¸¤ä¸ªå‚æ•°æ§åˆ¶å †çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚è¿™é‡Œæ˜¯**OOMå¼‚å¸¸çš„æ˜“å‘åŒº** åˆ†æˆæ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚ æ–°ç”Ÿä»£åˆåˆ†æˆ1ä¸ªEdenåŒºå’Œ2ä¸ªSurvivoråŒºï¼Œé»˜è®¤æ¯”ä¾‹8:1:1 ç»å¤§å¤šæ•°å¯¹è±¡åœ¨EdenåŒºç”Ÿæˆï¼Œ**å½“EdenåŒºå¡«æ»¡ï¼Œæˆ–è€…ä¸æ»¡è¶³æ–°å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè§¦å‘Young GCã€‚**å°†å­˜æ´»çš„å¯¹è±¡æ”¾è¿›Survivorã€‚Survivoråˆ†æˆä¸¤å—ï¼Œç”¨äºæ¯æ¬¡Young GCæ—¶ï¼Œå°†å­˜æ´»çš„å¯¹è±¡ç»Ÿç»Ÿå¤åˆ¶è¿›ç©ºçš„å¹¸å­˜åŒºï¼Œå°†æœ‰æ•°æ®çš„é‚£å—æ¸…ç©ºã€‚ å½“ä¸€ä¸ªå¯¹è±¡åœ¨ä¸¤ä¸ªsurvivoråŒºä¹‹é—´äº¤æ¢äº†ä¸€å®šæ¬¡æ•°ä¹‹åï¼Œå°†å¯¹è±¡æ‹·è´åˆ°è€å¹´ä»£ã€‚è¿™ä¸ªæ•°é‡ç”¨-XX:MaxTenuringThresholdé…ç½®ï¼Œé»˜è®¤å€¼æ˜¯15 æ–¹æ³•åŒº çº¿ç¨‹å…±äº«ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºï¼Œå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ï¼Œå³ç»ç¼–è¯‘å™¨ä¹‹åçš„æ•°æ®(è¿è¡Œæ—¶å¸¸é‡æ± [å­˜æ”¾classæ–‡ä»¶å…ƒä¿¡æ¯æè¿°ï¼Œç¼–è¯‘åçš„ä»£ç æ•°æ®ï¼Œå¼•ç”¨ç±»å‹æ•°æ®ï¼Œç±»æ–‡ä»¶å¸¸é‡æ± ]ã€å±æ€§å’Œæ–¹æ³•æ•°æ®)ï¼Œä»¥åŠæ–¹æ³•å’Œæ„é€ å‡½æ•°çš„ä»£ç ï¼ŒåŒ…æ‹¬åœ¨ç±»å’Œå®ä¾‹åˆå§‹åŒ–ä»¥åŠæ¥å£åˆå§‹åŒ–ä½¿ç”¨çš„ç‰¹æ®Šæ–¹æ³•ï¼Œæ–¹æ³•åŒºåœ¨é€»è¾‘ä¸Šæ˜¯å †çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒåˆæœ‰å¦ä¸€ä¸ªåˆ«åå«éå †ï¼Œç›®çš„æ˜¯ä¸å †åŒºåˆ†å¼€ã€‚æ–¹æ³•åŒºå¯ä»¥æ˜¯å›ºå®šå¤§å°ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è®¡ç®—éœ€è¦è¿›è¡Œæ‰©å±•ã€‚å¦‚æœæ–¹æ³•åŒºçš„å†…å­˜æ— æ³•æ»¡è¶³åˆ†é…è¯·æ±‚æ—¶ä¹Ÿä¼šæŠ›å‡ºOutOfMemoryErrorã€‚ æ°¸ä¹…ä»£ å…ƒç©ºé—´ JDK8ä½¿ç”¨å…ƒç©ºé—´ä»£æ›¿æ°¸ä¹…ä»£ï¼ˆç±»å…ƒä¿¡æ¯ï¼Œå­—æ®µï¼Œé™æ€å±æ€§ï¼Œæ–¹æ³•ï¼Œå¸¸é‡ï¼‰ï¼ŒåŒæ—¶è¿è¡Œæ—¶å¸¸é‡æ± ç­‰éƒ½ç§»åŠ¨åˆ°äº†å…ƒç©ºé—´ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± åœ¨å †ä¸­ã€‚ å…ƒç©ºé—´åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼Œå®ƒç‹¬ç«‹äºè¿è¡Œæ—¶æ•°æ®åŒºï¼Œä¹Ÿä¸æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç›´æ¥ä»æ“ä½œç³»ç»Ÿä¸­åˆ†é…ï¼Œå› æ­¤ä¸å—å †å¤§å°å½±å“ã€‚ä½†æ˜¯ä¼šå—åˆ°æœ¬æœºæ€»å†…å­˜å¤§å°ä»¥åŠå¤„ç†å™¨å¯»å€ç©ºé—´çš„é™åˆ¶ï¼Œå› æ­¤å®ƒä¹Ÿå¯èƒ½æŠ›å‡ºOOMå¼‚å¸¸ã€‚ åƒåœ¾å›æ”¶ æ‰¾åˆ°åƒåœ¾ â€‹ ä¸¤ç§æ–¹æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦éœ€è¦é”€æ¯ï¼š å¼•ç”¨è®¡æ•°æ³• â€‹ ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“å¯¹è±¡è¢«å¼•ç”¨ï¼Œå¼•ç”¨è®¡æ•°å™¨åŠ 1ã€‚å½“å¼•ç”¨å¤±æ•ˆï¼Œå‡ä¸€ã€‚è®¡æ•°å™¨ä¸ºé›¶ï¼Œä»£è¡¨è¯¥å¯¹è±¡å¯ä»¥è¢«å›æ”¶ã€‚ â€‹ **é—®é¢˜ï¼š**å¾ªç¯å¼•ç”¨é—®é¢˜ å¯è¾¾æ€§åˆ†æ â€‹ é€šè¿‡ä¸€ç³»åˆ—&quot;GC Roots&quot;çš„æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç”¨å¼•ç”¨é“¾è¿›è¡Œæœç´¢ï¼Œå‡¡æ˜¯åœ¨å¼•ç”¨é“¾ä¸Šçš„ï¼Œéƒ½ä¸ä¼šè¢«å›æ”¶ã€‚ â€‹ è§£å†³äº†å¾ªç¯ä¾èµ–é—®é¢˜ã€‚ åƒåœ¾å›æ”¶ç®—æ³•-GC æ ‡è®°-æ¸…é™¤ç®—æ³• é¦–å…ˆåœ¨å †å†…å­˜æ‰«æä¸€éï¼Œç„¶åæŠŠç°è‰²åŒºåŸŸçš„å¯¹è±¡æ ‡è®° ç»§ç»­æ‰«æï¼Œæ‰«æçš„åŒæ—¶å°†è¢«æ ‡è®°çš„å¯¹è±¡ç»Ÿä¸€å›æ”¶å›æ”¶åï¼š å›æ”¶ä¹‹åï¼Œäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚ éœ€è¦è¿›è¡Œæ ‡è®°ï¼Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹ï¼Œæ•ˆç‡ä¸é«˜ã€‚ å¤åˆ¶ç®—æ³• â€‹ å°†å†…å­˜åŒºåŸŸåˆ†æˆå¤§å°ä¸€æ ·çš„ä¸¤å—ï¼Œæ¯æ¬¡åªæ˜¯ç”¨ä¸€å—ï¼Œgcä¹‹åå°†å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ï¼Œç„¶åä¸€æ¬¡æ€§æ¸…ç†æ‰è¿™å—å†…å­˜ã€‚ å›æ”¶å‰ï¼š å›æ”¶åï¼š å¤åˆ¶ç®—æ³•çš„ç¼ºç‚¹æ˜¯ç‰ºç‰²äº†ä¸€åŠçš„å†…å­˜ç©ºé—´ï¼Œæœ‰ç‚¹æµªè´¹ã€‚å¤åˆ¶ç®—æ³•åœ¨JVMä¸­çš„ä½“ç°å°±æ˜¯ï¼šjavaå †å†…å­˜åšäº†å‡ æ¬¡åˆ’åˆ†ï¼ŒHot Spotè™šæ‹Ÿæœºä¸­Edenå’ŒSurvivorçš„æ¯”ä¾‹æ˜¯Eden:S0:S1=8:1:1ï¼Œå°†Survivoråˆ†æˆäº†ä¸¤ä¸ªåŒºåŸŸS0å’ŒS1æ¥è¿›è¡Œèµ‹å€¼ï¼Œè¿™ç§åšæ³•æ˜¯ä¸ºäº†å¼¥è¡¥åŸå§‹å¤åˆ¶ç®—æ³•ç›´æ¥å°†ä¸€åŠç©ºé—´ä½œä¸ºç©ºé—²ç©ºé—´çš„æµªè´¹ã€‚IBMå…¬å¸è¡¨ç¤ºï¼šYoungåŒºæœ‰98%çš„å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„ï¼Œç”Ÿå‘½å‘¨æœŸæçŸ­ï¼Œæ‰€ä»¥è¯´ä¸€æ¬¡GCä¸‹æ¥å­˜æ´»çš„å¯¹è±¡å¾ˆå°‘ï¼Œæ‰€ä»¥æ²¡å¿…è¦ç”¨ä¸€åŠç©ºé—´æ¥å¤åˆ¶ã€‚ æ ‡è®°-æ•´ç†ç®—æ³• â€‹ æ ‡è®°-æ•´ç†ç®—æ³•å°±æ˜¯ä¸ºäº†è€å¹´ä»£è€Œè®¾è®¡çš„ç®—æ³•ï¼Œæ ‡è®°-æ•´ç†ç®—æ³•å’Œæ ‡è®°-æ¸…é™¤ç®—æ³•çš„åŒºåˆ«åœ¨æœ€åä¸€æ­¥ï¼Œæ ‡è®°-æ•´ç†ä¸ä¼šç›´æ¥å¯¹å¯¹è±¡æ¸…ç†ï¼Œè€Œæ˜¯è¿›è¡Œç§»åŠ¨ï¼Œå°†å­˜æ´»å¯¹è±¡ç§»åŠ¨åˆ°ä¸€ç«¯ï¼Œç„¶åæ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å¯¹è±¡ã€‚ å›æ”¶å‰ï¼š å›æ”¶åï¼š åˆ†ä»£æ”¶é›†ç®—æ³• â€‹ ç›®å‰ä¸»æµçš„å•†ä¸šè™šæ‹Ÿæœºéƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œè¿™ç§ç®—æ³•å°±æ˜¯ä¸Šé¢ä¸‰ç§ç®—æ³•çš„ç»“åˆã€‚æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†æˆ–æ ‡è®°-æ¸…é™¤ç®—æ³•ã€‚ åƒåœ¾æ”¶é›†å™¨ Serial å’ŒSerial Old æ”¶é›†å™¨ Serial å•çº¿ç¨‹ï¼ŒGCæ—¶Stop The Worldï¼ˆSTWï¼‰ï¼Œæš‚åœæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ã€‚ Serial Old å•çº¿ç¨‹ï¼Œä½œç”¨ä¸è€å¹´ä»£ã€‚æ ‡è®°æ•´ç†ç®—æ³• â€‹ ä¼˜ç‚¹ï¼šå•çº¿ç¨‹æ”¶é›†æ•ˆç‡é«˜ â€‹ ç¼ºç‚¹ï¼šéœ€è¦STWï¼Œæš‚åœæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹ â€‹ ç®—æ³•ï¼š Serialé‡‡ç”¨å¤åˆ¶ç®—æ³• ï¼›Serial Oldé‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³• ParNewæ”¶é›†å™¨ â€‹ ParNewæ”¶é›†å™¨æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œå®ç°å¹¶è¡Œæ”¶é›†ï¼Œ åŸç†è·ŸSerialä¸€è‡´ï¼ˆå¹¶è¡ŒæŒ‡çš„æ˜¯å¤šä¸ªGCçº¿ç¨‹å¹¶è¡Œï¼Œä½†æ˜¯ç”¨æˆ·çº¿ç¨‹è¿˜æ˜¯æš‚åœï¼Œå¹¶å‘æŒ‡çš„æ˜¯ç”¨æˆ·çº¿ç¨‹å’ŒGCçº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼‰ã€‚ParNewé»˜è®¤å¼€å¯å’ŒCPUä¸ªæ•°ç›¸åŒçš„çº¿ç¨‹æ•°è¿›è¡Œå›æ”¶ã€‚ â€‹ ä¼˜ç‚¹ï¼šåœ¨å¤šCPUæ—¶ï¼Œæ¯”Serialçš„æ•ˆç‡é«˜ã€‚ â€‹ ç¼ºç‚¹ï¼šè¿˜æ˜¯éœ€è¦STWï¼Œå•CPUæ—¶æ¯”Serialæ•ˆç‡ä½ â€‹ ç®—æ³•ï¼šå¤åˆ¶ç®—æ³• Parallel Scavenge æ”¶é›†å™¨ æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä¹Ÿæ˜¯å¤åˆ¶ç®—æ³•ï¼Œå’ŒParNewä¸€æ ·å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ï¼Œæ›´å…³æ³¨ç³»ç»Ÿçš„ååé‡[ååé‡=(è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´) / (è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´+ GC æ—¶é—´) ]Parallel Scavenge æä¾›äº†ä¸¤ä¸ªå‚æ•°ç”¨äºç²¾ç¡®æ§åˆ¶ååé‡ï¼š 123456789-XX:MaxGCPauseMillis //GCæœ€å¤§åœé¡¿æ¯«ç§’æ•°ï¼Œå¿…é¡»å¤§äº0-XX:GCTimeRation //è®¾ç½®ååé‡å¤§å°ï¼Œå¤§äº0å°äº100ï¼Œé»˜è®¤å€¼ä¸º99-XX:+UseAdaptiveSizePolicy //å¼€å¯è‡ªé€‚åº”ç­–ç•¥//ä½ ä¼šä¸ä¼šè§‰å¾—æŠŠMaxGCPauseMillisè®¾ç½®å°ç‚¹å°±ä¼šè®©GCé€Ÿåº¦å˜å¿«ï¼Ÿ//ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå¦‚æœè®¾ç½®æ—¶é—´è¿‡å°ï¼ŒParallel Scavenge ä¼šç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥äº¤æ¢ï¼Œ//æ¯”å¦‚æ–°ç”Ÿä»£400Mbéœ€è¦GCæ—¶é—´ä¸º100msï¼Œè®¾ç½®æˆ50msäº†ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠæ–°ç”Ÿä»£è°ƒå°ä¸º200Mbï¼Œè¿™æ ·è‚¯å®šæ—¶é—´å°±é™ä¸‹æ¥äº†ï¼Œ//ç„¶è€Œè¿™ç§æ“ä½œå¯èƒ½ä¼šé™ä½ååé‡ï¼ŒåŸå…ˆ10sè§¦å‘ä¸€æ¬¡GCï¼Œæ¯æ¬¡100msï¼Œ// ä¿®æ”¹æ—¶é—´åå˜æˆ5sè§¦å‘ä¸€æ¬¡GCï¼Œæ¯æ¬¡70msï¼Œé‚£ä¹ˆ10msè§¦å‘ä¸¤æ¬¡GCçš„æ—¶é—´å˜æˆäº†140msï¼Œååé‡åè€Œé™ä½ã€‚ Parallel Old æ”¶é›†å™¨ æ˜¯Parallel Scavenge çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä½¿ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œå› ä¸ºParallel Scavenge æ— æ³•å’ŒCMSæ­é…ä½¿ç”¨ï¼Œæ‰€ä»¥åªèƒ½å’ŒSerial Oldã€‚è‡ªä»Parallel Oldå‡ºç°ï¼Œå°±æœ‰äº†Parallel Scavenge +Parallel Oldçš„ç»„åˆï¼Œè¿™æ˜¯JDK8ä½¿ç”¨çš„ï¼Œæ³¨é‡ååé‡çš„ä¸€ç»„æ”¶é›†å™¨ã€‚ CMSæ”¶é›†å™¨ è¿™æ˜¯ä¼˜åŒ–GCåœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼Œå¹¶å‘å›æ”¶ï¼ˆä»ç„¶éœ€è¦STWï¼Œä½†æ˜¯æ—¶é—´å¾ˆçŸ­ï¼‰ã€‚é€šè¿‡-XX:+UseMarkSweepGCå¯ç”¨ã€‚CMSåŸºäºæ ‡è®°-æ¸…é™¤ç®—æ³•å®ç°ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››æ­¥ï¼š åˆå§‹æ ‡è®°ï¼šéœ€è¦STWï¼Œæ ‡è®°GC Rootså¯¹è±¡ã€‚ å¹¶å‘æ ‡è®°ï¼šè¿™ä¸ªé˜¶æ®µå¯ä»¥å’Œç”¨æˆ·çº¿ç¨‹ä¸€èµ·è¿›è¡Œï¼Œåˆ†ä¸ºä¸‰æ­¥ï¼š æ ¹æ®ç¬¬ä¸€æ­¥æ‰¾åˆ°çš„GC Rootså¼€å§‹æœç´¢è·ŸGC Rootsç›¸è¿çš„å¯¹è±¡ã€‚ é¢„æ¸…ç†ï¼šå¤„ç†å¹¶å‘æ ‡è®°ä¹‹åå‘ç”Ÿå˜åŒ–çš„å¯¹è±¡ã€‚ å¯è¢«ç»ˆæ­¢çš„é¢„æ¸…ç†ï¼šæœ‰ä¸€ä¸ªabort è§¦å‘æ¡ä»¶ï¼Œè¯¥é˜¶æ®µå­˜åœ¨çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½å‘ç”Ÿä¸€æ¬¡Young GCï¼Œæ¥å‡å°‘YoungåŒºå¯¹è±¡æ•°é‡ï¼Œé™ä½é‡æ–°æ ‡è®°çš„å·¥ä½œé‡ï¼Œå› ä¸ºé‡æ–°æ ‡è®°ä¼šæ‰«ææ•´ä¸ªå †å†…ç©ºé—´ï¼Œå¯ä»¥é€šè¿‡å‚æ•°-XX:+CMSScavangeBeforeRemark æ§åˆ¶åœ¨é‡æ–°æ ‡è®°å‰å‘ç”Ÿä¸€æ¬¡Young GCï¼Œé»˜è®¤ä¸ºfalseã€‚ é‡æ–°æ ‡è®°ï¼šéœ€è¦STWï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯ä¸ºäº†ä¿®æ­£åœ¨é˜¶æ®µ2æ ‡è®°ä¹‹åäº§ç”Ÿå˜åŒ–çš„å¯¹è±¡ã€‚ å¹¶å‘æ¸…é™¤ï¼šå’Œç”¨æˆ·çº¿ç¨‹åŒæ—¶è¿›è¡Œï¼Œå¼€å§‹æ­£å¼æ¸…ç†åƒåœ¾ï¼Œæ­¤é˜¶æ®µäº§ç”Ÿçš„åƒåœ¾ç•™å¾…ä¸‹æ¬¡æ¸…é™¤ã€‚ ä¼˜ç‚¹ï¼šå¹¶å‘æ”¶é›†ï¼Œä½åœé¡¿ ç¼ºç‚¹ï¼šäº§ç”Ÿå¤§é‡ç¢ç‰‡ï¼Œå¹¶å‘é˜¶æ®µä¼šé™ä½ååé‡ G1æ”¶é›†å™¨ â€‹ G1æ˜¯ä»¥ä¼˜åŒ–GCåœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼Œå®ƒå°è¯•ä»¥é«˜æ¦‚ç‡æ»¡è¶³GCåœé¡¿æ—¶é—´ä¸ºç›®æ ‡ï¼ŒåŒæ—¶å®ç°é«˜ååé‡ã€‚åœ¨G1ä¸­ï¼Œå°†å †çš„æ•´ä¸ªå†…å­˜å¸ƒå±€åšäº†ä¿®æ”¹ï¼Œåœ¨G1ä¸­æ•´ä¸ªå †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸRegionï¼Œè™½ç„¶åœ¨é€»è¾‘ä¸Šè¿˜ä¿ç•™äº†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œä½†æ˜¯ç‰©ç†ä¸Šå·²ç»éš”ç¦»äº†ï¼ŒG1çš„å †å†…å­˜å¸ƒå±€å¦‚ä¸‹å›¾ ï¼š ä¸Šå›¾æ™ºèƒ½æŸœè¢«åˆ’åˆ†æˆä¸€ç»„å¤§å°ç›¸åŒçš„Regionï¼Œæ¯ä¸ªRegionéƒ½æ˜¯è¿ç»­çš„è™šæ‹Ÿå†…å­˜èŒƒå›´ï¼ŒG1å¯ä»¥çŸ¥é“å“ªä¸ªRegionåŒºåŸŸå†…å¤§éƒ¨åˆ†æ˜¯ç©ºçš„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ¯æ¬¡å…è®¸çš„æ”¶é›†æ—¶é—´å†…ä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„RegionåŒºåŸŸï¼ˆæ ¹æ®å›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶éœ€è¦çš„æ—¶é—´ç»¼åˆè€ƒè™‘ï¼‰æ‰€ä»¥è¿™å°±æ˜¯G1å«åšGarbage-Firstçš„åŸå› ã€‚G1æ˜¯JDK8é»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨ã€‚G1çš„å·¥ä½œæµç¨‹å’ŒCMSå¾ˆç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨æœ€åçš„æ­¥éª¤ã€‚ä¹Ÿæœ‰å››æ­¥ï¼š åˆå§‹æ ‡è®°ï¼šéœ€è¦STWï¼Œæ ‡è®°ä¸‹GC Rootså…³è”çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹TAMSï¼ˆNext Top at Mark Startï¼‰çš„å€¼ï¼Œä½¿å¾—ä¸‹ä¸€é˜¶æ®µå¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½åœ¨æ­£ç¡®å¯ç”¨çš„Regionä¸­åˆ›å»ºå¯¹è±¡ã€‚ å¹¶å‘æ ‡è®°ï¼šå’ŒCMSä¸€æ ·ï¼Œä¸»è¦æ˜¯è¿›è¡ŒGC Rootsçš„å‘ä¸‹æœç´¢ï¼Œæ‰¾å‡ºå­˜æ´»å¯¹è±¡è¿›è¡Œæ ‡è®°ã€‚ æœ€ç»ˆæ ‡è®°ï¼šéœ€è¦STWï¼Œå’ŒCMSä¸€æ ·ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºè¿è¡Œè€Œå¯¼è‡´å˜åŠ¨çš„å¯¹è±¡ã€‚ ç­›é€‰å›æ”¶ï¼šå¯¹å„ä¸ªRegionçš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æœŸæœ›çš„GCåœé¡¿æ—¶é—´åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚ G1çš„ç¬¬ä¸€ä¸ªé‡ç‚¹æ˜¯ä¸ºè¿è¡Œéœ€è¦å¤§å †ä¸”GCå»¶è¿Ÿæœ‰é™çš„åº”ç”¨ç¨‹åºçš„ç”¨æˆ·æä¾›è§£å†³æ–¹æ¡ˆï¼Œè¿™å°±æ„å‘³ç€å †å¤§å°çº¦ä¸º6Gæˆ–æ›´å¤§ï¼Œå¹¶ä¸”ç¨³å®šä¸”å¯é¢„æµ‹çš„æš‚åœæ—¶é—´ä½äº0.5ç§’ã€‚å¦‚æœåº”ç”¨ç¨‹åºå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼Œå¯ä»¥è€ƒè™‘åˆ‡æ¢åˆ°G1æ”¶é›†å™¨ï¼š è¶…è¿‡50%çš„Javaå †è¢«å®æ—¶æ•°æ®å ç”¨ å¯¹è±¡åˆ†é…ç‡æˆ–æå‡ç‡å·®å¼‚å¾ˆå¤§ å½“å‰åº”ç”¨ç¨‹åºGCåœé¡¿æ—¶é—´è¶…è¿‡0.5ç§’ï¼Œåˆæƒ³ç¼©çŸ­åœé¡¿æ—¶é—´ å„æ”¶é›†å¯¹æ¯” æ”¶é›†å™¨ ä¸²è¡Œ/å¹¶è¡Œ/å¹¶å‘ æ–°ç”Ÿä»£/è€å¹´ä»£ ç®—æ³• ç›®æ ‡ é€‚ç”¨åœºæ™¯ Serial ä¸²è¡Œ æ–°ç”Ÿä»£ å¤åˆ¶ å“åº”é€Ÿåº¦ä¼˜å…ˆ å•CPUç¯å¢ƒä¸‹çš„Clientæ¨¡å¼ Serial Old ä¸²è¡Œ è€å¹´ä»£ æ ‡è®°-æ•´ç† å“åº”é€Ÿåº¦ä¼˜å…ˆ å•CPUç¯å¢ƒä¸‹çš„Clientæ¨¡å¼ï¼ŒCMSçš„åå¤‡é¢„æ¡ˆ ParNew å¹¶è¡Œ æ–°ç”Ÿä»£ å¤åˆ¶ å“åº”é€Ÿåº¦ä¼˜å…ˆ å¤šCPUç¯å¢ƒæ—¶åœ¨Serveræ¨¡å¼ä¸‹ä¸CMSé…åˆä½¿ç”¨ Parallel Scavenge å¹¶è¡Œ æ–°ç”Ÿä»£ å¤åˆ¶ ååé‡ä¼˜å…ˆ åœ¨åå°è¿ç®—ä¸”ä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ Parallel å¹¶è¡Œ è€å¹´ä»£ æ ‡è®°-æ•´ç† ååé‡ä¼˜å…ˆ åœ¨åå°è¿ç®—ä¸”ä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ CMS å¹¶å‘ è€å¹´ä»£ æ ‡è®°-æ¸…é™¤ å“åº”é€Ÿåº¦ä¼˜å…ˆ é›†ä¸­åœ¨äº’è”ç½‘ç½‘ç«™ æˆ– B/Sç³»ç»ŸæœåŠ¡ç«¯ä¸­çš„Javaåº”ç”¨ G1 å¹¶å‘ å…¼é¡¾ æ ‡è®°-æ•´ç†+å¤åˆ¶ å“åº”é€Ÿåº¦ä¼˜å…ˆ é¢å‘æœåŠ¡ç«¯åº”ç”¨ ä¸²è¡Œæ”¶é›†å™¨ï¼šSerialå’ŒSerial Oldå•çº¿ç¨‹æ”¶é›†ï¼Œé€‚ç”¨äºå†…å­˜è¾ƒå°çš„åµŒå…¥å¼è®¾å¤‡ã€‚ å¹¶è¡Œæ”¶é›†å™¨ã€ååé‡ä¼˜å…ˆã€‘ï¼šParallel Scavenge + Parallel Oldï¼Œé€‚ç”¨äºç§‘å­¦è®¡ç®—ã€åå°å¤„ç†ç­‰åœºæ™¯ã€‚ å¹¶å‘æ”¶é›†å™¨ã€GCåœé¡¿æ—¶é—´ä¼˜å…ˆã€‘ï¼šCMSå’ŒG1ï¼Œé€‚ç”¨äºå¯¹æ—¶é—´æœ‰è¦æ±‚çš„åœºæ™¯ï¼Œä¾‹å¦‚Webåº”ç”¨ã€‚ è°ƒä¼˜ æ‰€è°“è°ƒä¼˜å°±æ˜¯è®¾ç½®ä¸€ä¸ªåˆç†çš„JVMå‚æ•°ï¼Œé€‚é…å½“å‰ç³»ç»Ÿè¿è¡Œã€‚ å‚æ•° å¯ä»¥åˆ†æˆä¸‰ç±»ï¼šæ ‡å‡†å‚æ•°ï¼Œ-Xå‚æ•°ï¼Œ-XXå‚æ•° æ ‡å‡†å‚æ•° â€‹ ä»¥&quot;-&quot;å¼€å¤´çš„å‚æ•°ç§°ä¸ºæ ‡å‡†å‚æ•°ï¼Œæ˜¯ä»»ä½•ä¸€ä¸ªJDKç‰ˆæœ¬éƒ½æ”¯æŒçš„ï¼Œæ¯”è¾ƒç¨³å®šï¼Œä¸ä¼šéšç‰ˆæœ¬æ›´æ–°å’Œæ”¹å˜ã€‚ä¾‹å¦‚-version,-help,-serverã€‚ -Xå‚æ•° â€‹ ä»¥-Xå¼€å¤´çš„å‚æ•°æ˜¯åœ¨ç‰¹å®šç‰ˆæœ¬HotSpotæ”¯æŒçš„å‘½ä»¤ã€‚JDKç‰ˆæœ¬å˜åŒ–ä¹‹åï¼Œå‚æ•°å¯èƒ½å˜åŒ–ï¼Œè¿™ä¸ªå‚æ•°ç”¨çš„è¾ƒå°‘ã€‚ -XXå‚æ•° -XXæ˜¯ä¸ç¨³å®šçš„å‚æ•°ï¼Œä¹Ÿæ˜¯ä¸»è¦å‚æ•°ï¼Œåˆ†ä¸ºBooleanç±»å‹å’ŒéBooleanç±»å‹ã€‚ Booleanç±»å‹ -XX:[+-]&lt;name&gt;ï¼š+æˆ–-è¡¨ç¤ºå¯ç”¨æˆ–è€…ç¦ç”¨nameå±æ€§ 123456è¡¨ç¤ºå¯ç”¨CMSåƒåœ¾æ”¶é›†å™¨-XX:+UseConcMarkSweepGCè¡¨ç¤ºå¯ç”¨G1åƒåœ¾æ”¶é›†å™¨-XX:+UseG1GCè¡¨ç¤ºæ‰“å°å‡ºæ‰€æœ‰çš„JVMå‚æ•°ä¿¡æ¯-XX:+PrintFlagsFinal éBooleanç±»å‹ -XX&lt;name&gt;=&lt;value&gt;ï¼šnameè¡¨ç¤ºå±æ€§ï¼Œvalueè¡¨ç¤ºå±æ€§å¯¹åº”çš„å€¼ 12è®¾ç½®æœ€å¤§æ°¸ä¹…ä»£ç©ºé—´å¤§å°ä¸º5M-XX:MaxMetaspaceSize=5M å…¶ä»– 123-Xms1000 ç­‰ä»·äº -XX:InitialHeapSize=1000-Xmx1000 ç­‰ä»·äº -XX:MaxHeapSize=1000-Xss1000 ç­‰ä»·äº -XX:ThreadStackSize=1000 å¸¸ç”¨å‚æ•° è®¾ç½® è¯´æ˜ -XX:ClCompilerCount=3 æœ€å¤§å¹¶è¡Œç¼–è¯‘æ•°ï¼Œå¤§äº1æ—¶å¯ä»¥æé«˜ç¼–è¯‘é€Ÿåº¦ï¼Œä½†ä¼šå½±å“ç³»ç»Ÿç¨³å®šæ€§ -XX:InitialHeapSize=100m åˆå§‹å †å¤§å°ï¼Œå¯ä»¥ç®€å†™ä¸º-Xms100 -XX:MaxHeapSize æœ€å¤§å †å¤§å°ï¼Œå¯ä»¥ç®€å†™ä¸º-Xmx100 -XX:NewSize=20m è®¾ç½®å¹´è½»ä»£å¤§å° -XX:MaxNewSize è®¾ç½®å¹´è½»ä»£æœ€å¤§å€¼ -XX:OldSize=50m è®¾ç½®è€å¹´ä»£å¤§å° -XX:MetaspaceSize=50m è®¾ç½®æ–¹æ³•åŒºå¤§å°ï¼ŒJDK8æ‰æœ‰ï¼Œç”¨å…ƒç©ºé—´ä»£æ›¿æ–¹æ³•åŒº -XX:+UseParallelGC è®¾ç½®Parallel Scavengeä½œä¸ºæ–°ç”Ÿä»£æ”¶é›†å™¨ç³»ç»Ÿé»˜è®¤ä¼šé€‰æ‹©Parallel Oldä½œä¸ºè€å¹´ä»£æ”¶é›†å™¨ -XX:NewRatio æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”å€¼æ¯”å¦‚ -XX:NewRatio=4è¡¨ç¤ºæ–°ç”Ÿä»£ï¼šè€å¹´ä»£=1ï¼š4 -XX:SurvivorRatio è¡¨ç¤ºSurvivoråŒºå’ŒEdenåŒºçš„æ¯”å€¼æ¯”å¦‚-XX:SurvivorRatio=8è¡¨ç¤ºï¼ˆS0æˆ–S1):Eden=1:8 å‘½ä»¤ç›‘æ§å·¥å…· å¾…ç»­ å‚è€ƒï¼š Java SE Specifications (oracle.com) JVMä¸‡å­—æ€»ç»“ - æ˜é‡‘ (juejin.cn) ã€JVMç³»åˆ—8ã€‘JVMçŸ¥è¯†ç‚¹æ€»è§ˆ - æ˜é‡‘ (juejin.cn) JVM8å†…å­˜æ¨¡å‹_jdk8å†…å­˜æ¨¡å‹_ä½™ç”Ÿä¹‹å›çš„åšå®¢-CSDNåšå®¢ JVMå†…å­˜æ¨¡å‹æ€»ç»“ï¼Œæœ‰å„ç‰ˆæœ¬JDKå¯¹æ¯”ã€æœ‰å…ƒç©ºé—´OOMç›‘æ§æ¡ˆä¾‹ã€æœ‰Javaç‰ˆè™šæ‹Ÿæœºï¼Œç»¼åˆå®è·µå­¦ä¹ ï¼ - å°å‚…å“¥ - åšå®¢å›­ (cnblogs.com) https://zhuanlan.zhihu.com/p/297001119","categories":[{"name":"Java","slug":"Java","permalink":"https://solitaire-12.github.io/categories/Java/"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://solitaire-12.github.io/tags/JVM/"}]},{"title":"å†…ç½‘ç©¿é€","slug":"Server/å†…ç½‘ç©¿é€","date":"2024-03-18T09:05:07.000Z","updated":"2024-03-18T09:06:56.415Z","comments":true,"path":"2024/03/18/Server/å†…ç½‘ç©¿é€/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","excerpt":"","text":"ç¯å¢ƒï¼š æœåŠ¡ç«¯é˜¿é‡Œäº‘ï¼š CentOS 8.5.2111 å®¢æˆ·ç«¯ï¼šwindows 11 / windows 10 frp 0.42 ç¬¬ä¸€æ­¥ å®˜ç½‘ä¸‹è½½frpè½¯ä»¶ ç¬”è€…ä½¿ç”¨çš„ç‰ˆæœ¬ï¼šé“¾æ¥ï¼šhttps://pan.baidu.com/s/1cjmUiOY8iRIywx6whkhRdg æå–ç ï¼šgatr ç¬¬äºŒæ­¥ æœåŠ¡ç«¯ï¼š å°† frp_0.42.0_linux_amd64.tar.gzå‹ç¼©åŒ…ä¼ ç»™linux è¿›å…¥åˆ°æ–‡ä»¶å­˜æ”¾ç›®å½• 123tar -zxvf frp_0.42.0_linux_amd64.tar.gzcd frp_0.42.0_linux_amd64/vi frps.ini ğŸ’¬æé†’ï¼šåªè¦bind_portçš„7000ç«¯å£æ²¡è¢«å ç”¨ï¼Œä¸€èˆ¬ä¸å»ºè®®ä¿®æ”¹ã€‚ 12./frps -c frps.ini #ä¸´æ—¶å¯åŠ¨nohup ./frps -c frps.ini &amp; #æ°¸ä¹…å¯åŠ¨ å®¢æˆ·ç«¯ï¼š è§£å‹ frp_0.42.0_windows_amd64.zip ï¼Œæ³¨æ„å…³é—­ä¸€ä¸‹æ€æ¯’è½¯ä»¶ã€‚ æ‰“å¼€ä¹‹åï¼Œä¿®æ”¹frpc.iniæ–‡ä»¶ã€‚ ğŸ’¬è§£é‡Šï¼š 12[ssh]å®šä¹‰ä¸€ä¸ªä½¿ç”¨ [type] åè®®çš„url: [local_ip]:[local_port]è¢«[server_addr]:[remote_port]ä»£ç†äº†ã€‚å³ï¼šç”¨æˆ·è®¿é—® [server_addr]:[remote_port] åï¼ŒæœåŠ¡å™¨&quot;è·³è½¬&quot;åˆ° [local_ip]:[local_port] å¯åŠ¨ 12# è¿›å…¥cmdfrpc.exe -c frpc.ini âš ï¸æ³¨æ„ï¼šå‡å¦‚ä½ å°†frpc.iniä¸­çš„remote_portå’Œfrps.iniä¸­çš„dashboard_porté…ç½®æˆä¸€æ ·çš„è¯ï¼Œå¯åŠ¨å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç° [ssh] start error: port unavailableã€‚","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|é¡¹ç›®éƒ¨ç½²","slug":"Server/é¡¹ç›®ä¸Šçº¿","date":"2024-03-18T08:25:07.000Z","updated":"2024-03-18T09:02:45.468Z","comments":true,"path":"2024/03/18/Server/é¡¹ç›®ä¸Šçº¿/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF/","excerpt":"","text":"ç¯å¢ƒ ç³»ç»Ÿï¼šCentos 8.4.2105 docker : 24.0.5 nginx: nginx/1.25.1 åç«¯ å®¿ä¸»æœºå®‰è£… åç«¯è¾¾æˆjaråŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ ps -ef | grep javaæŸ¥çœ‹æœ‰æ²¡æœ‰åœ¨è¿è¡Œçš„javaé¡¹ç›®ï¼Œè¦æ˜¯ç«¯å£å†²çªçš„è¯ï¼Œç›´æ¥kill java -jaræ²¡æœ‰é—®é¢˜ä¹‹åï¼Œnohup java -jar x.jar &gt; x.log 2&gt;&amp;1 &amp; å°±å¯ä»¥ã€‚ dockerå†…éƒ¨ åˆ›å»ºDockerfile vi Dockerfile 1234FROM openjdk:8ADD 18080.jar test.jarEXPOSE 18080ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;test.jar&quot;] æè¿°ï¼š FROM openjdk:8:æ‹‰å–åŸºç¡€é•œåƒ ADD 18080.jar test.jarï¼šå°†18080.jarå¤åˆ¶åˆ°é•œåƒä¸­ï¼Œé‡å‘½åæˆtest.jar EXPOSE 18080:å£°æ˜ç«¯å£ï¼Œä¸€èˆ¬æŒ‡å®šçš„æ˜¯jarè¿è¡Œç«¯å£ ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;test.jar&quot;]ï¼šå®¹å™¨å¯åŠ¨ä¹‹åæ‰§è¡Œçš„å‘½ä»¤ MAINTAINER xx: æ·»åŠ ä½œè€…ä¿¡æ¯ æ„å»ºé•œåƒ 1docker build -t test . æè¿°ï¼š testï¼šé•œåƒåç§° .ï¼šè¡¨ç¤ºDockerfileåœ¨å½“å‰ç›®å½•ä¸‹ æŸ¥çœ‹é•œåƒ 1docker images è¿è¡Œè¿›è¡Œ 1docker run -d --restart=always --name test -p 8080:18080 test æè¿°ï¼š -dï¼šè¡¨ç¤ºåå°è¿è¡Œå®¹å™¨ --restart=alwaysï¼šä»£è¡¨å®¹å™¨åœ¨åœæ­¢æˆ–è€…æœåŠ¡å™¨å¼€æœºä¹‹åä¼šè‡ªåŠ¨é‡å¯ --name test:å‘½åæˆtest -p 8080:18080ï¼šç«¯å£æ˜ å°„ [å®¿ä¸»æœºç«¯å£]:[å®¹å™¨ç«¯å£] test:è¿è¡Œçš„é•œåƒ æ›´æ–°jaråŒ… 1docker cp new.jar [å®¹å™¨id]:/test.jar éšåï¼Œé‡å¯å®¹å™¨ Dockeréƒ¨ç½²å¯æ‰§è¡ŒjaråŒ…-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº (aliyun.com) å‰ç«¯ é¡¹ç›®æ‰“åŒ… æ‰“åŒ…ä¹‹åå°†é¡¹ç›®æ”¾åœ¨æŒ‚è½½çš„htmlç›®å½•ä¸‹,è¯¦æƒ…æŸ¥çœ‹dockerå®‰è£…nginx | çº¿ä¸Šè·³è½¬â†—ï¸ æŒ‚è½½é¡¹ç›®ï¼š å°†é¡¹ç›®æŒ‚è½½åˆ°æ–‡ä»¶å¤¹aé‡Œè¾¹ é…ç½®nginx ä¿®æ”¹å‰çš„é…ç½®æ–‡ä»¶ï¼š ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶ï¼š æ³¨æ„äº‹é¡¹ è¦æ˜¯jarè¿è¡Œåœ¨å®¿ä¸»æœº(å®‰è£…dokcerçš„æœåŠ¡å™¨)ä¸Šé¢çš„è¯ï¼Œå»ºè®®server_nameä¿®æ”¹æˆ172.17.0.1(è¿™ä¸ªåœ°å€æ˜¯å®‰è£…dockerä¹‹åï¼Œé»˜è®¤ç”Ÿæˆçš„ç½‘æ¡¥)ã€‚ç”¨ifconfig -aå¯ä»¥æŸ¥çœ‹Linux çš„IPåœ°å€ ä¸è¦åœ¨ localtion / &#123;&#125;è¿™å—é‡Œè¾¹å–å†™ proxy_passï¼Œä¼šç½‘é¡µéƒ½æ‰“ä¸å¼€ã€‚ å€˜è‹¥æœ‰ç¬¬äºŒä¸ªå‰ç«¯é¡¹ç›®çš„è¯ï¼ŒåŒæ ·htmlç›®å½•ä¸‹é¢åˆ›å»ºæŒ‚è½½æ–‡ä»¶å¤¹å¹¶æŠŠæ–‡ä»¶å­˜æ”¾åœ¨å†…ã€‚ç„¶ååœ¨å†™ä¸€ä¸ªlocaltionå—ï¼Œä¿®æ”¹ä¸€ä¸‹listenç«¯å£ã€‚ä¾‹å¦‚ï¼š é—®é¢˜æ’æŸ¥ï¼š 1.è¿è¡ŒjaråŒ…æœåŠ¡å™¨å¡æ­» ç¯å¢ƒï¼š ç³»ç»Ÿï¼š8.5.2111 é…ç½®ï¼š2æ ¸2G ç›®æ ‡æœåŠ¡ï¼š Minioï¼Œfrpï¼Œdockerï¼Œnginxï¼Œredisï¼Œmysqlï¼Œå‰ç«¯ï¼Œåç«¯ åœºæ™¯ï¼š æœåŠ¡å™¨è¿è¡Œç€Minioï¼Œfrpï¼Œnginxï¼Œdockerï¼Œredis-dockerï¼Œmysql-dockerï¼Œå‰ç«¯ã€‚å°†åç«¯jaråŒ…ä¸Šä¼ æœåŠ¡å™¨ï¼Œnohup java -jar xx &amp;è¿æ¥æœåŠ¡å™¨çš„xshellæ•²å‘½ä»¤æ‰§è¡Œå¡é¡¿ï¼Œæ— æ³•é‡è¿xshellï¼ŒéšåæœåŠ¡å™¨å¡æ­»ã€‚ é—®é¢˜æ’æŸ¥ï¼š è§‚å¯Ÿåˆ°xshellå‘½ä»¤è¿˜æ˜¯èƒ½æ•²ä¸Šçš„ï¼Œä½†æ˜¯é”®ç›˜æ•²å‡»ä¹‹åï¼Œxshellç•Œé¢å¾ˆä¹…æ‰èƒ½å›æ˜¾ï¼Œæ‰§è¡Œä¹Ÿè¦å¾ˆä¹…å¾ˆä¹…ï¼Œè€Œä¸”é‡è¿xshellä¹Ÿæ˜¯å¾ˆé•¿æ—¶é—´è¿æ¥ä¸ä¸Šã€‚ ç±»ä¼¼è¿™ç§ååº”æ—¶é—´å¾ˆé•¿ï¼Œç³»ç»Ÿå‡ºç°&quot;æ­»æœº&quot;çš„ç°è±¡ï¼Œå¤šåŠæ˜¯å†…å­˜ä¸è¶³ã€‚ ä¸ºå•¥ä¼šå†…å­˜ä¸è¶³å‘¢ï¼Ÿ é‡å¯æœåŠ¡å™¨ä¹‹åï¼Œé‡æ–°é…ç½®å¥½éœ€è¦çš„ç¯å¢ƒï¼Œä¸è¿è¡ŒjaråŒ…ã€‚æŸ¥çœ‹topå‘½ä»¤ï¼š è§‚å¯Ÿå…¶ä¸­çš„è¿›ç¨‹ï¼Œæ³¨æ„åˆ°æœ‰ä¸ªmysqldå ç”¨äº†22.4%çš„å­˜ï¼Œæ•´å°æœåŠ¡å™¨çš„å†…å­˜æ˜¯2Gï¼Œå®é™…è¿è¡Œèµ·æ¥æŒ‡å®šæ²¡æœ‰2048Mçš„ï¼Œä»¥åŠå…¶ä»–ä¸€äº›ç³»ç»Ÿæ”¯æŒçš„ï¼Œç®—äºæŸ10%ï¼Œç©ºé—²å†…å­˜å®é™…çº¦ä¸º1850Mã€‚åˆ¨å»mysqldé»˜è®¤å ç”¨çš„1Gï¼Œå®é™…å ç”¨çš„450Mã€‚è¦æƒ³ç»´ç³»æ•´ä¸ªç³»ç»Ÿçš„å¼€æ”¯ï¼Œå¯ç”¨å†…å­˜ä¹Ÿå°±1Gå·¦å³ã€‚ å°†jaråœ¨å¼€å‘ç¯å¢ƒä¸Šè¿è¡Œï¼Œè§‚å¯Ÿåˆ°å…¶å ç”¨äº†å¼€å‘ç”µè„‘1000-1300Mçš„å†…å­˜èµ„æºã€‚ è§£å†³æ–¹æ¡ˆä¹Ÿå°±å‘¼ä¹‹æ¬²å‡ºäº†ï¼š é…ç½®java -jarJVMçš„å‚æ•°ï¼Œé™å®šå…¶å†…å­˜å¤§å°ã€‚ä¾‹å¦‚ï¼š 1java -Xmx512M -jar xxx.jar ä»mysqldä¸Šè§£å†³ï¼Œå‚è€ƒ1 å‚è€ƒ2 å®ƒæ˜¯Performance Schema çš„å¤§å°ï¼Œé»˜è®¤é…ç½®æ˜¯1Gã€‚ æ­¤æ—¶åŸºæœ¬è§£å†³å†…å­˜ä¸è¶³é—®é¢˜ã€‚ 2.jaråŒ…è¿è¡Œï¼ŒCPUé£™å‡è‡³190% ç¯å¢ƒï¼š ç³»ç»Ÿï¼š8.5.2111 é…ç½®ï¼š2æ ¸2G ç›®æ ‡æœåŠ¡å™¨ä»»åŠ¡è¿›ç¨‹ï¼š Minioï¼Œfrpï¼Œdockerï¼Œnginxï¼Œredisï¼Œmysqlï¼Œå‰ç«¯ï¼Œåç«¯ åœºæ™¯ï¼š æœåŠ¡å™¨è¿è¡Œç€Minioï¼Œfrpï¼Œnginxï¼Œdockerï¼Œredis-dockerï¼Œmysql-dockerï¼Œå‰ç«¯ã€‚å°†åç«¯jaråŒ…ä¸Šä¼ æœåŠ¡å™¨ï¼Œnohup java -jar xx &amp;åï¼ŒtopæŒ‡ä»¤ç›‘æµ‹åˆ°cpuå¤„åœ¨190%é™„è¿‘ã€‚ é—®é¢˜æ’æŸ¥ï¼š é€šè¿‡ å‘½ä»¤ï¼ŒæŸ¥çœ‹è¯¥è¿›ç¨‹ä¸‹çš„çº¿ç¨‹èµ„æºå ç”¨æƒ…å†µã€‚ 1ps -mp pid -o THREAD,tid,time å°†å…¶ä¸­%CPUé«˜çš„çº¿ç¨‹TIDè¿›è¡Œè½¬ç  1print &quot;%x\\n&quot; TID é€šè¿‡æŸ¥çœ‹cpuå ç”¨å¾ˆé«˜çš„çº¿ç¨‹çŠ¶æ€ 1jstack PID | grep [0xTID:ç¬¬äºŒéƒ¨è½¬ç å‡ºæ¥çš„tid] å¦‚æœçº¿ç¨‹è¿˜å¤„åœ¨RunnableçŠ¶æ€ï¼Œé‚£ä¹ˆé€šè¿‡jstackå»æ‰¾åˆ°è¯¦æƒ…ã€‚å¦‚æœé—®é¢˜æŒ‡å‘ä»£ç ï¼Œé‚£å°±å»ä¿®æ”¹ã€‚ åˆ°æ­¤åŸºæœ¬è§£å†³ã€‚ å½“ç„¶ï¼Œè¿˜æœ‰ä¸ªæƒ…å†µå°±æ˜¯ï¼Œæ­£å¸¸å¯åŠ¨ç›´æ¥æ‹‰çˆ†ï¼Œéšååˆé™é»˜åˆ°1%çš„ï¼ŒæŸ¥çº¿ç¨‹é«˜å ç”¨çš„éƒ½åœæ­¢äº†ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå€˜è‹¥åæœŸè¿˜æœ‰MQä»€ä¹ˆçš„å…¶ä»–æœåŠ¡è¦ç”¨çš„è¯ï¼Œå»ºè®®å°†å‡çº§åˆ°4æ ¸cpuã€‚","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"éƒ¨ç½²","slug":"éƒ¨ç½²","permalink":"https://solitaire-12.github.io/tags/%E9%83%A8%E7%BD%B2/"}]},{"title":"linux|dockerå®‰è£…RabbitMQ","slug":"Server/dockerå®‰è£…RabbitMQ","date":"2024-03-18T08:23:07.000Z","updated":"2024-03-18T08:40:58.750Z","comments":true,"path":"2024/03/18/Server/dockerå®‰è£…RabbitMQ/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/docker%E5%AE%89%E8%A3%85RabbitMQ/","excerpt":"","text":"å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼šwindowsä¸‹è½½erlang ä¸‹è½½RabbitMQ ä¸‹è½½RabbitMQæºç  Dockerå®‰è£…RabbitMQ 12345678910111213# æŸ¥æ‰¾rabbitmqé•œåƒdocker search rabbitmq# pullé•œåƒdocker pull rabbitmq# è¿è¡Œmq ## -p [æš´éœ²çš„å®¿ä¸»æœºç«¯å£]:[dockerå†…éƒ¨ç«¯å£]docker run -d --hostname rabbit-test --name rabbit \\-p 15672:15672 -p 5672:5672 rabbitmq# è¿›å…¥mqé•œåƒdocker exec -it [å®¹å™¨id] /bin/bash# è¿è¡Œrabbitmq-plugins enable rabbitmq_management# é»˜è®¤è´¦å·å¯†ç ï¼šguestï¼šguest","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|dockerå®‰è£…nginx","slug":"Server/dockerå®‰è£…nginx","date":"2024-03-18T08:23:07.000Z","updated":"2024-03-18T08:33:54.888Z","comments":true,"path":"2024/03/18/Server/dockerå®‰è£…nginx/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/docker%E5%AE%89%E8%A3%85nginx/","excerpt":"","text":"centos8.5.2111 æ‹‰å–é•œåƒ 1docker pull nginx åˆ›å»ºNginxæŒ‚è½½ç›®å½• 123mkdir -p mytools/nginx/confmkdir -p mytools/nginx/logmkdir -p mytools/nginx/html å°†å®¹å™¨ä¸­çš„é…ç½®å¤åˆ¶åˆ°å®¿ä¸»æœº 12345678# ç”Ÿæˆå®¹å™¨docker run --name nginx -p 9001:80 -d nginx# å°†å®¹å™¨nginx.confæ–‡ä»¶å¤åˆ¶åˆ°å®¿ä¸»æœºdocker cp nginx:/etc/nginx/nginx.conf /mytools/nginx/conf/nginx.conf# å°†å®¹å™¨conf.dæ–‡ä»¶å¤¹ä¸‹å†…å®¹å¤åˆ¶åˆ°å®¿ä¸»æœºdocker cp nginx:/etc/nginx/conf.d /mytools/nginx/conf/conf.d# å°†å®¹å™¨ä¸­çš„htmlæ–‡ä»¶å¤¹å¤åˆ¶åˆ°å®¿ä¸»æœºdocker cp nginx:/usr/share/nginx/html /mytools/nginx/ æ­£å¼å¯åŠ¨nginx 12345678docker run \\-p 9002:80 \\--name nginx \\-v /mytools/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \\-v /mytools/nginx/conf/conf.d:/etc/nginx/conf.d \\-v /mytools/nginx/log:/var/log/nginx \\-v /mytools/nginx/html:/usr/share/nginx/html \\-d nginx:latest æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ 1curl localhost:9002 å…¬ç½‘IPè®¿é—® ä¿®æ”¹htmlæŸ¥çœ‹è¿è¡ŒçŠ¶æ€ æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ 1docker restart nginx","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|dockerå®‰è£…redis","slug":"Server/dockerå®‰è£…redis","date":"2024-03-18T08:22:07.000Z","updated":"2024-03-18T08:31:58.663Z","comments":true,"path":"2024/03/18/Server/dockerå®‰è£…redis/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/docker%E5%AE%89%E8%A3%85redis/","excerpt":"","text":"centos 8.5.2111 æ‹‰å–redisé•œåƒ 1docker pull redis å‡†å¤‡redisçš„é…ç½®æ–‡ä»¶ å®˜ç½‘ï¼š redis 6.0.6 ä¸‹è½½ â€“ Redisä¸­å›½ç”¨æˆ·ç»„ï¼ˆCRUGï¼‰ æŠŠredis.confä¸Šä¼ åˆ°æœåŠ¡å™¨rediså®‰è£…çš„ä½ç½® é…ç½®redis.confæ–‡ä»¶ bind 127.0.0.1 #æ³¨é‡Šæ‰è¿™éƒ¨åˆ†ï¼Œä½¿rediså¯ä»¥å¤–éƒ¨è®¿é—® daemonize no#ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ requirepass ä½ çš„å¯†ç #ç»™redisè®¾ç½®å¯†ç  appendonly yes#redisæŒä¹…åŒ– é»˜è®¤æ˜¯no tcp-keepalive 300 #é˜²æ­¢å‡ºç°è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥çš„é”™è¯¯ é»˜è®¤æ˜¯300 123456789101112#æ³¨é‡Šæ‰è¿™éƒ¨åˆ†ï¼Œä½¿rediså¯ä»¥å¤–éƒ¨è®¿é—®bind 127.0.0.1 #ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨daemonize no#ç»™redisè®¾ç½®å¯†ç requirepass ä½ çš„å¯†ç #redisæŒä¹…åŒ– é»˜è®¤æ˜¯noappendonly yes#é˜²æ­¢å‡ºç°è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥çš„é”™è¯¯ é»˜è®¤æ˜¯300tcp-keepalive 300 # :/[findword] åœ¨viå‘½ä»¤ä¸­å¯»æ‰¾æ–‡å­—ï¼Œæœ€å¥½åŠ ä¸ªç©ºæ ¼å»æ‰¾ åˆ›å»ºæœ¬åœ°ä¸dockeræ˜ å°„ç›®å½• 12mkdir mytools/redismkdir mytools/redis/data æŠŠä¸Šè¿°çš„redis.confå¤åˆ¶åˆ°redisç›®å½•ä¸‹ å¯åŠ¨ 1sudo docker run -p 6379:6379 --name redis -v /mytools/redis/redis.conf:/etc/redis/redis.conf -v /mytools/redis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes -p 6379:6379:æŠŠå®¹å™¨å†…çš„6379ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœº6379ç«¯å£-v /data/redis/redis.conf:/etc/redis/redis.confï¼šæŠŠå®¿ä¸»æœºé…ç½®å¥½çš„redis.confæ”¾åˆ°å®¹å™¨å†…çš„è¿™ä¸ªä½ç½®ä¸­-v /data/redis/data:/dataï¼šæŠŠredisæŒä¹…åŒ–çš„æ•°æ®åœ¨å®¿ä¸»æœºå†…æ˜¾ç¤ºï¼Œåšæ•°æ®å¤‡ä»½redis-server /etc/redis/redis.confï¼šè¿™ä¸ªæ˜¯å…³é”®é…ç½®ï¼Œè®©redisä¸æ˜¯æ— é…ç½®å¯åŠ¨ï¼Œè€Œæ˜¯æŒ‰ç…§è¿™ä¸ªredis.confçš„é…ç½®å¯åŠ¨â€“appendonly yesï¼šrediså¯åŠ¨åæ•°æ®æŒä¹…åŒ– æŸ¥çœ‹æ—¥å¿—ï¼šdocker logs redis","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|dockerå®‰è£…minio","slug":"Server/minio","date":"2024-03-18T08:22:07.000Z","updated":"2024-03-18T09:10:40.271Z","comments":true,"path":"2024/03/18/Server/minio/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/minio/","excerpt":"","text":"ç¯å¢ƒ centos 8.5 åˆ›å»ºminioæ–‡ä»¶å¤¹ 12mkdir /mytools/miniocd /mytools/minio wgetä¸‹è½½minio 1wget https://dl.minio.io/server/minio/release/linux-amd64/minio åˆ›å»ºæ—¥å¿—ï¼Œæˆæƒ 12touch minio.logchmod 777 minio å¯åŠ¨minio 12# åé¢è·Ÿç€çš„æ˜¯é™æ€æ–‡ä»¶æŒ‚è½½ç›®å½•./minio server /opt/minio/data **é—®é¢˜åŸå› ï¼š**ç¬”è€…ç¼–å†™æ–‡æ¡£ä¹‹å‰ï¼Œè¿è¡Œè¿‡minioï¼Œè¿™é‡Œæ˜¾ç¤ºç«¯å£å ç”¨é—®é¢˜ï¼Œkillä¸€ä¸‹è¿›ç¨‹å°±å¥½äº† çº¢å­—ï¼šè­¦å‘Š:æ£€æµ‹åˆ°é»˜è®¤å‡­æ®â€™minioadmin:minioadminâ€™ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨ä½¿ç”¨â€™MINIO_ROOT_USERâ€™å’Œâ€™MINIO_ROOT_PASSWORDâ€™ç¯å¢ƒå˜é‡æ›´æ”¹è¿™äº›å€¼ é…ç½®ç¯å¢ƒå˜é‡ 12345vim /etc/profile export MINIO_ROOT_USER=fileadmin export MINIO_ROOT_PASSWORD=fileadminsource /etc/profile æŒ‡å®šç«¯å£é‡å¯minio 12# æœ‰éœ€æ±‚è‡ªå·±æ¢æˆè‡ªå·±çš„å­˜æ”¾ç›®å½•./minio server /opt/minio/data --console-address &quot;:9050&quot; è®¾ç½®åå°å¯åŠ¨ 12345vim start.shnohup /mytools/minio/minio server /opt/minio/data --console-address &quot;:9050&quot; &gt; /opt/minio/minio.log 2&gt;&amp;1 &amp;sh start.sh é—®é¢˜ï¼š minioæœåŠ¡éƒ¨ç½²åœ¨äº‘ç«¯æ—¶ï¼Œé…ç½®æœåŠ¡ç½‘ç«™è¦ç”¨å…¬ç½‘ipï¼Œä¸ç„¶æ²¡åŠæ³•å›æ˜¾","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|dockerå®‰è£…mysql8","slug":"Server/dockerå®‰è£…mysql8","date":"2024-03-18T08:21:07.000Z","updated":"2024-03-18T08:29:42.068Z","comments":true,"path":"2024/03/18/Server/dockerå®‰è£…mysql8/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/docker%E5%AE%89%E8%A3%85mysql8/","excerpt":"","text":"æ‹‰å–é•œåƒ 1docker pull mysql:8.0.23 æ£€æŸ¥é•œåƒ 1docker images å¯åŠ¨é•œåƒ 1234567891011sudo docker run -p 3306:3306 --name mysql \\-v /usr/local/docker/mysql/mysql-files:/var/lib/mysql-files \\-v /usr/local/docker/mysql/conf:/etc/mysql \\-v /usr/local/docker/mysql/logs:/var/log/mysql \\-v /usr/local/docker/mysql/data:/var/lib/mysql \\-e MYSQL_ROOT_PASSWORD=root \\-d mysql:8.0.23docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root -d mysql 1docker logs -f mysql #æŸ¥çœ‹å¯åŠ¨æ—¥å¿— è¿›å…¥å®¹å™¨ 1docker exec -it mysql bash æ–¹æ³•äºŒ ä¸‹è½½mysql 1docker pull mysql:8.0.23 åˆ›å»ºæ–‡ä»¶å¤¹åšæŒ‚è½½ 12345//åˆ›å»ºæ–‡ä»¶å¤¹åšæŒ‚è½½mkdir -p /mydata/mysql/confmkdir /mydata/mysql/data//åˆ›å»ºmy.cnfé…ç½®æ–‡ä»¶vi /mydata/mysql/conf/my.cnf my.cnfæ·»åŠ å¦‚ä¸‹å†…å®¹ 123456789101112131415[mysqld]user=mysqlcharacter-set-server=utf8default_authentication_plugin=mysql_native_passwordsecure_file_priv=/var/lib/mysqlexpire_logs_days=7sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTIONmax_connections=1000lower_case_table_names=1 [client]default-character-set=utf8 [mysql]default-character-set=utf8 æ³¨æ„ï¼š ä½ çš„æ•°æ®åº“è¦æ˜¯ä»æœ¬åœ°windowsä¸Šè¿ç§»åˆ°linuxçš„è¯ï¼Œlower_case_table_names=1,è¿™ä¸ªä¸€å®šè¦åŠ ä¸Šï¼Œä¸ç„¶çš„è¯è¦é‡æ–°éƒ¨ç½²ï¼Œå¾ˆéº»çƒ¦ åˆ›å»ºå®¹å™¨ 12345678910docker run \\--restart=always \\--privileged=true \\-p 3306:3306 --name mysql \\-v /mydata/mysql/log:/var/log/mysql \\-v /mydata/mysql/data:/var/lib/mysql \\-v /mydata/mysql/conf/my.cnf:/etc/mysql/my.cnf \\-v /mydata/mysql/conf/conf.d:/etc/mysql/conf.d \\-e MYSQL_ROOT_PASSWORD=root \\-d mysql:8.0 è¿›å…¥å®¹å™¨ 1docker exec -it mysql bash è¿›å…¥mysql 123mysql -u root -p# æŸ¥çœ‹æ•°æ®åº“show databases","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|å®‰è£…Git/Maven","slug":"Server/GitMaven","date":"2024-03-18T08:20:07.000Z","updated":"2024-03-18T08:23:14.809Z","comments":true,"path":"2024/03/18/Server/GitMaven/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/GitMaven/","excerpt":"","text":"å®‰è£…Git 1yum install -y git æ ¡éªŒå®‰è£…ç»“æœ 1git --version å®‰è£…maven åˆ›å»ºå­˜æ”¾mavençš„æ–‡ä»¶å¤¹ 1mkdir -p /mytools/maven å°†maven.gzä¸Šä¼ åˆ°è¯¥æ–‡ä»¶å¤¹ è§£å‹ 1tar -xvf apache-maven-3.9.4-bin.tar.gz é…ç½®ç¯å¢ƒå˜é‡ 1234vim /etc/profile export MAVEN_HOME=/mydata/maven/apache-maven-3.9.4 export PATH=$&#123;MAVEN_HOME&#125;/bin:$PATHsource /etc/profile éªŒè¯ 1mvn -v é…ç½®é˜¿é‡Œé•œåƒ(çœ‹æƒ…å†µ)","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|å®‰è£…Docker","slug":"Server/docker","date":"2024-03-18T08:20:07.000Z","updated":"2024-03-18T08:26:17.374Z","comments":true,"path":"2024/03/18/Server/docker/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/docker/","excerpt":"","text":"ç¯å¢ƒ ï¼š centos 8.4.2105 æ£€æŸ¥æ˜¯å¦å­˜åœ¨docker 1docker -v å¸è½½docker 12345678910yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-selinux \\ docker-engine-selinux \\ docker-engine 123yum remove docker-ce \\ docker-ce-cli \\ containerd è®¾ç½®ä»“åº“ 1sudo yum install -y yum-utils device-mapper-persistent-data lvm2 ç¨³å®šä»“åº“ 12# é˜¿é‡Œäº‘sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 1234# æ¸…åé•œåƒsudo yum-config-manager \\ --add-repo \\ https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo å®‰è£… Docker Engine-Community 1sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin é—®é¢˜ï¼š åŸå› ï¼šCentOS-8äº2021å¹´12æœˆ31æ—¥åœæ­¢äº†æºçš„æœåŠ¡ è§£å†³æ­¥éª¤ï¼š 1234567# 1cd /etc/yum.repos.d# 2mkdir bakcp * bak/# 3vi root_.repo #æŠŠenabled=1ï¼Œæ”¹æˆenable=0 æŒ‡å®šç‰ˆæœ¬å®‰è£… 123456789$ yum list docker-ce --showduplicates | sort -rdocker-ce.x86_64 3:18.09.1-3.el7 docker-ce-stabledocker-ce.x86_64 3:18.09.0-3.el7 docker-ce-stabledocker-ce.x86_64 18.06.1.ce-3.el7 docker-ce-stabledocker-ce.x86_64 18.06.0.ce-3.el7 docker-ce-stable$ sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io å¯åŠ¨docker 123sudo systemctl start docker# è¿è¡Œhello-worldé•œåƒï¼ŒæŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸsudo docker run hello-world å¸è½½docker 1234# åˆ é™¤å®‰è£…åŒ…yum remove docker-ce# åˆ é™¤é•œåƒã€å®¹å™¨ã€é…ç½®æ–‡ä»¶ç­‰å†…å®¹rm -rf /var/lib/docker centos 8.2å®‰è£…é—®é¢˜ è®¾ç½®ä»“åº“æ—¶å‘ç”Ÿé—®é¢˜ï¼š è§£å†³ï¼šæ›´æ–°ä¸€ä¸‹yum 1yum -y update å‡ºç°Failed to download metadata for repo â€˜appstreamâ€™: Cannot prepare internal mirrorlist: No URLs in mirrorlist é—®é¢˜åŸå› ï¼š å› ä¸ºcentos8é¡¹ç›®å®˜æ–¹å·²äº2021å¹´åº•åœæ­¢ç»´æŠ¤ï¼Œç›¸å…³æºå·²æ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥ç½‘ä¸Š22å¹´å‰çš„æ¢æºæ•™ç¨‹éƒ½å·²æ— æ³•ä½¿ç”¨ã€‚ è§£å†³ï¼š 12345678#è¿›å…¥é…ç½®æ–‡ä»¶ç›®å½•cd /etc/yum.repos.d/#åˆ é™¤æ—§çš„é…ç½®æ–‡ä»¶rm -rf *.repo# ä¸‹è½½å¯ç”¨çš„.repoæ–‡ä»¶wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo# è¿è¡Œ yum makecache ç”Ÿæˆç¼“å­˜yum makecache","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"linux|å®‰è£…JDK","slug":"Server/JDK","date":"2024-03-18T08:14:07.000Z","updated":"2024-03-18T08:23:34.967Z","comments":true,"path":"2024/03/18/Server/JDK/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/JDK/","excerpt":"","text":"æ¸…åäº‘ä¸‹è½½jdk ï¼š https://repo.huaweicloud.com/java/ 12345678910111213141516171819202122# æŸ¥çœ‹æ˜¯å¦å®‰è£…è¿‡jdkrpm -qa | grep java# â†‘è¿™é‡Œè¦æ˜¯å­˜åœ¨å†…å®¹ï¼Œæ‰§è¡Œåˆ é™¤rpm -qa | grep java | xargs rpm -e --nodeps# æŸ¥çœ‹javaç‰ˆæœ¬java -version# åˆ›å»ºå­˜æ”¾javaçš„æ–‡ä»¶mkdir /usr/java# cdè¿›å…¥è¿™ä¸€ä¸ªæ–‡ä»¶å¤¹# æŠŠä¸‹è½½å¥½çš„jdkä¸Šä¼ åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹# è§£å‹tar -xvf jdk1.8.0_202ar.gz# é…ç½®ç¯å¢ƒvi /etc/profile# åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ  ã€æ³¨æ„=é™„è¿‘ä¸è¦æœ‰ç©ºæ ¼ã€‘export JAVA_HOME=/usr/java/jdk1.8.0_202export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib/ export PATH=$PATH:$JAVA_HOME/bin# åˆå§‹åŒ–é…ç½® - æ‰§è¡Œè¿™æ¡è¯­å¥ï¼Œå¯ä»¥è®©ç¯å¢ƒç«‹å³ç”Ÿæ•ˆï¼Œä¸éœ€è¦é‡å¯source /etc/profile# æŸ¥çœ‹ç‰ˆæœ¬ (æœ‰ä¿¡æ¯çš„è¯ï¼Œå°±å®‰è£…æˆåŠŸäº†)java -version å¦‚æœä¸Šè¿°ä¸­æ²¡æœ‰æ·»åŠ åˆ°ç¯å¢ƒä¸­ï¼Œå°è¯•ç»ˆç«¯ç›´æ¥è¿è¡Œä»¥ä¸‹ä»£ç  1234export JAVA_HOME=/mytools/java/jdk1.8.0_202export JRE_HOME=$&#123;JAVA_HOME&#125;/jreexport CLASSPATH=:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/libexport PATH=$&#123;JAVA_HOME&#125;/bin:$PATH","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"Hexo|å›¾ç‰‡ç›¸å…³","slug":"Hexo/Hexo-å›¾ç‰‡ç›¸å…³","date":"2024-03-18T07:14:55.000Z","updated":"2024-03-18T07:55:33.857Z","comments":true,"path":"2024/03/18/Hexo/Hexo-å›¾ç‰‡ç›¸å…³/","permalink":"https://solitaire-12.github.io/2024/03/18/Hexo/Hexo-%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/","excerpt":"","text":"1.ç›¸å¯¹è·¯å¾„æŒ‚è½½å›¾ç‰‡ã€æ–‡ç« æ˜¾ç¤ºã€‘ åœ¨ _config.ymlæ–‡ä»¶ä¸­é…ç½® post_asset_folder 1234post_asset_folder: truemarked: prependRoot: true postAsset: true ğŸ’¬é…ç½®ä¹‹åï¼Œå½“æ‰§è¡Œ hexo new titleNameä¹‹åï¼Œä¼šåœ¨è¯¥titleName.mdæ–‡ä»¶å¤¹çš„åŒçº§ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªåŒåæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾å›¾ç‰‡èµ„æºã€‚ .mdæ–‡ä»¶ä¸­ä½¿ç”¨ 1![](photoName.jpg) ğŸ’¬hexo-renderer-markedé»˜è®¤æ¸²æŸ“å¼•æ“ï¼Œé€šè¿‡hexo gä¹‹åï¼Œä¼šå°†è¯¥å›¾ç‰‡è·¯å¾„æ¸²æŸ“æˆç»å¯¹è·¯å¾„ã€‚åœ¨æ–‡ç« åˆ—è¡¨ä¸­ï¼Œæ— æ³•åŠ è½½å›¾ç‰‡ã€‚ 2.ç»å¯¹è·¯å¾„æŒ‚è½½å›¾ç‰‡ã€ä¸»é¡µæ˜¾ç¤ºã€‘ åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªimgæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾å›¾ç‰‡ .mdæ–‡ä»¶ä¸­ä½¿ç”¨ 1![](/img/photoName.jpg) ğŸ’¬/imgä»£è¡¨æ ¹ç›®å½•ä¸‹çš„imgæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­ /æŒ‡ä»£æ ¹ç›®å½•ã€publicæ–‡ä»¶å¤¹ã€‘ 3.åŒæ—¶æ˜¾ç¤º å®‰è£… hexo-asset-image 1npm hexo-asset-image --save å®‰è£…ä¹‹åï¼Œå‘ç°å›¾ç‰‡è·¯å¾„éƒ½ä¸æ˜¾ç¤ºäº†ï¼ŒF12æŸ¥çœ‹å›¾ç‰‡è·¯å¾„å˜æˆäº†/.io//xxx.xxã€‚ ä¿®å¤ä¸Šè¿°bugã€‚è¿›å…¥åˆ°node_modulesæ‰¾åˆ°hexo-asset-imageæ’ä»¶ï¼Œç”¨ä¸‹è¿°ä»£ç æ›¿æ¢æ‰index.jsåŸæœ‰ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&quot;use strict&quot;;var cheerio = require(&quot;cheerio&quot;);// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-stringfunction getPosition(str, m, i) &#123; return str.split(m, i).join(m).length;&#125;var version = String(hexo.version).split(&quot;.&quot;);hexo.extend.filter.register(&quot;after_post_render&quot;, function (data) &#123; var config = hexo.config; if (config.post_asset_folder) &#123; var link = data.permalink; if (version.length &gt; 0 &amp;&amp; Number(version[0]) == 3) var beginPos = getPosition(link, &quot;/&quot;, 1) + 1; else var beginPos = getPosition(link, &quot;/&quot;, 3) + 1; // In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;. var endPos = link.lastIndexOf(&quot;/&quot;) + 1; link = link.substring(beginPos, endPos); var toprocess = [&quot;excerpt&quot;, &quot;more&quot;, &quot;content&quot;]; for (var i = 0; i &lt; toprocess.length; i++) &#123; var key = toprocess[i]; var $ = cheerio.load(data[key], &#123; ignoreWhitespace: false, xmlMode: false, lowerCaseTags: false, decodeEntities: false, &#125;); $(&quot;img&quot;).each(function () &#123; if ($(this).attr(&quot;src&quot;)) &#123; // For windows style path, we replace &#x27;\\&#x27; to &#x27;/&#x27;. var src = $(this).attr(&quot;src&quot;).replace(&quot;\\\\&quot;, &quot;/&quot;); if (!/http[s]*.*|\\/\\/.*/.test(src) &amp;&amp; !/^\\s*\\//.test(src)) &#123; // For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed. // In addition, to support multi-level local directory. var linkArray = link.split(&quot;/&quot;).filter(function (elem) &#123; return elem != &quot;&quot;; &#125;); var srcArray = src.split(&quot;/&quot;).filter(function (elem) &#123; return elem != &quot;&quot; &amp;&amp; elem != &quot;.&quot;; &#125;); if (srcArray.length &gt; 1) srcArray.shift(); src = srcArray.join(&quot;/&quot;); $(this).attr(&quot;src&quot;, config.root + link + src); console.info &amp;&amp; console.info(&quot;update link as:--&gt;&quot; + config.root + link + src); &#125; &#125; else &#123; console.info &amp;&amp; console.info(&quot;no src attr, skipped...&quot;); console.info &amp;&amp; console.info($(this)); &#125; &#125;); data[key] = $.html(); &#125; &#125;&#125;); æ›¿æ¢ä¹‹åï¼Œé‡æ–°hexo gå³å¯ã€‚ 4.æ”¯æŒemoji hexo-renderer-markedé»˜è®¤æ¸²æŸ“å¼•æ“å¹¶ä¸æ”¯æŒemojiï¼Œå´æ¢åˆ°å¯ä»¥æ”¯æŒçš„æ¸²æŸ“å¼•æ“ã€‚ç¬”è€…ä½¿ç”¨çš„æ˜¯ hexo-renderer-markdown-itã€‚ 12npm un hexo-renderer-marked --savenpm i hexo-renderer-markdown-it --save åœ¨ _config.ymlæ–‡ä»¶ä¸­é…ç½®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243# hexo-renderer-markdown-itmarkdown: preset: &quot;default&quot; render: html: true xhtmlOut: false langPrefix: &quot;language-&quot; breaks: true linkify: true typographer: true quotes: &quot;â€œâ€â€˜â€™&quot; enable_rules: disable_rules: plugins: - markdown-it-abbr - markdown-it-cjk-breaks - markdown-it-deflist - markdown-it-emoji - markdown-it-footnote - markdown-it-ins - markdown-it-mark - markdown-it-sub - markdown-it-sup # - markdown-it-checkbox # - markdown-it-imsize # - markdown-it-expandable - name: markdown-it-container options: success - name: markdown-it-container options: tips - name: markdown-it-container options: warning - name: markdown-it-container options: danger anchors: level: 2 collisionSuffix: &quot;&quot; permalink: false permalinkClass: &quot;header-anchor&quot; permalinkSide: &quot;left&quot; permalinkSymbol: &quot;Â¶&quot; case: 0 separator: &quot;-&quot; å‚è€ƒï¼š Hexoå›¾ç‰‡ç›¸å…³ - æ–‡ç« æ˜¾ç¤ºã€ä¸»é¡µæ˜¾ç¤ºã€ä¿®æ”¹fancybox_hexo æ–‡ç« ç¼©ç•¥-CSDNåšå®¢ ã€Hexoã€‘é€‰æ‹©æ›´é«˜çº§çš„Markdownæ¸²æŸ“å™¨_hexo-renderer-marked-CSDNåšå®¢","categories":[{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://solitaire-12.github.io/categories/%E5%8D%9A%E5%AE%A2/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"https://solitaire-12.github.io/tags/Hexo/"}]},{"title":"æ•°æ®ç®¡ç†DMS","slug":"Server/dms","date":"2024-03-18T05:40:07.000Z","updated":"2024-03-18T09:12:06.386Z","comments":true,"path":"2024/03/18/Server/dms/","permalink":"https://solitaire-12.github.io/2024/03/18/Server/dms/","excerpt":"","text":"ä¸‹è½½ï¼šæ•°æ®ç®¡ç†DMSâ€“ä¸‹è½½ä¸­å¿ƒ (aliyun.com) æœ¬åœ°éƒ¨ç½²ï¼š å®‰è£…å¥½ä¹‹åï¼Œç™»å½•å®ä¾‹å³å¯ã€‚ é—®é¢˜ï¼šå†…ç½‘IPé“¾æ¥å¤±è´¥ è§£å†³æ–¹æ³•ï¼šã€æœ¬åœ°æ•°æ®åº“æ˜¯MySQLã€‘ ç™»å½•æ•°æ®åº“ï¼Œåˆ‡æ¢åˆ°mysql 1select user,host from user; # æŸ¥çœ‹ä¿¡æ¯ âš ï¸ä¸Šè¿°ä¿¡æ¯æ˜¯æŒ‡è¯¥ç”¨æˆ·ååªèƒ½é€šè¿‡localhostè¿™ä¸ªåœ°å€è¿›è¡Œè®¿é—®ã€‚ ä¿®æ”¹rootç”¨æˆ·çš„host 1update user set host =&quot;%&quot; where user = &quot;root&quot;; åˆ·æ–°æƒé™ 1flush privileges;","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"tags":[{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"}]},{"title":"Hello World","slug":"hello-world","date":"2024-03-14T05:00:15.235Z","updated":"2024-03-18T07:17:22.799Z","comments":true,"path":"2024/03/14/hello-world/","permalink":"https://solitaire-12.github.io/2024/03/14/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick Start Create a new post 1$ hexo new &quot;My New Post&quot; More info: Writing Run server 1$ hexo server More info: Server Generate static files 1$ hexo generate More info: Generating Deploy to remote sites 1$ hexo deploy More info: Deployment","categories":[{"name":"åˆå§‹","slug":"åˆå§‹","permalink":"https://solitaire-12.github.io/categories/%E5%88%9D%E5%A7%8B/"}],"tags":[]}],"categories":[{"name":"Java","slug":"Java","permalink":"https://solitaire-12.github.io/categories/Java/"},{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://solitaire-12.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://solitaire-12.github.io/categories/%E5%8D%9A%E5%AE%A2/"},{"name":"åˆå§‹","slug":"åˆå§‹","permalink":"https://solitaire-12.github.io/categories/%E5%88%9D%E5%A7%8B/"}],"tags":[{"name":"Java8","slug":"Java8","permalink":"https://solitaire-12.github.io/tags/Java8/"},{"name":"JVM","slug":"JVM","permalink":"https://solitaire-12.github.io/tags/JVM/"},{"name":"å®‰è£…","slug":"å®‰è£…","permalink":"https://solitaire-12.github.io/tags/%E5%AE%89%E8%A3%85/"},{"name":"éƒ¨ç½²","slug":"éƒ¨ç½²","permalink":"https://solitaire-12.github.io/tags/%E9%83%A8%E7%BD%B2/"},{"name":"Hexo","slug":"Hexo","permalink":"https://solitaire-12.github.io/tags/Hexo/"}]}